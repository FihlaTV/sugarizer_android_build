/*! Sugarizer 2017-08-25 */
define(["webL10n"],function(a){function b(a){var b=a+1;return b==xoPalette.colors.length&&(b=0),b}function c(a){var b=a-1;return b<0&&(b=xoPalette.colors.length-1),b}function d(a){return a>64&&a<91?a-65:a>96&&a<123?a-71:a>47&&a<58?a+4:43===a?62:47===a?63:0}function e(a,b){for(var c,e,f=a.replace(/[^A-Za-z0-9\+\/]/g,""),g=f.length,h=b?Math.ceil((3*g+1>>2)/b)*b:3*g+1>>2,i=new Uint8Array(h),j=0,k=0,l=0;l<g;l++)if(e=3&l,j|=d(f.charCodeAt(l))<<6*(3-e),3===e||g-l===1){for(c=0;c<3&&k<h;c++,k++)i[k]=j>>>(16>>>c&24)&255;j=0}return i}var f={},g=[{name:"Years",factor:30758400},{name:"Months",factor:2592e3},{name:"Weeks",factor:604800},{name:"Days",factor:86400},{name:"Hours",factor:3600},{name:"Minutes",factor:60}];return f.timestampToElapsedString=function(b,c,d){for(var e=d?"_short":"",f=0,h="",i=((new Date).getTime()-b)/1e3,j=0;j<g.length;j++){var k=g[j].factor,l=Math.floor(i/k);if(l>0&&(f>0&&(h+=","),h+=" "+l+" "+(1==l?a.get(g[j].name+"_one"+e):a.get(g[j].name+"_other"+e)),i-=l*k),""!=h&&(f+=1),f==c)break}return 0==f?a.get("SecondsAgo"+e):a.get("Ago"+e,{time:h})},f.getDateRange=function(a){if(void 0===a)return null;var b=new Date,c=new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime();b=b.getTime();var d=null;switch(a){case 1:d={min:c,max:b};break;case 2:d={min:c-864e5,max:b};break;case 3:d={min:c-6048e5,max:b};break;case 4:d={min:c-2592e6,max:b};break;case 5:d={min:c-307584e5,max:b}}return d},f.getNextStrokeColor=function(a){var c=f.getColorIndex(a);if(c==-1)return a;for(var d=b(c);xoPalette.colors[d].stroke!=xoPalette.colors[c].stroke;)d=b(d);return xoPalette.colors[d]},f.getPreviousStrokeColor=function(a){var b=f.getColorIndex(a);if(b==-1)return a;for(var d=c(b);xoPalette.colors[d].stroke!=xoPalette.colors[b].stroke;)d=c(d);return xoPalette.colors[d]},f.getNextFillColor=function(a){var c=f.getColorIndex(a);if(c==-1)return a;for(var d=b(c);xoPalette.colors[d].fill!=xoPalette.colors[c].fill;)d=b(d);return xoPalette.colors[d]},f.getPreviousFillColor=function(a){var b=f.getColorIndex(a);if(b==-1)return a;for(var d=c(b);xoPalette.colors[d].fill!=xoPalette.colors[b].fill;)d=c(d);return xoPalette.colors[d]},f.getColorIndex=function(a){for(var b=0;b<xoPalette.colors.length;b++)if(a.stroke==xoPalette.colors[b].stroke&&a.fill==xoPalette.colors[b].fill)return b;return-1},f.getCanvasCenter=function(){var a=document.getElementById("canvas"),b=a.offsetHeight,c=a.offsetWidth,d=parseFloat(b)/2,e=parseFloat(c)/2;return{x:e,y:d,dx:c,dy:b}},f.computeMargin=function(a,b){var c=document.getElementById("canvas"),d=c.offsetHeight,e=c.offsetWidth,f=a.width<=e?a.width:b.width*e,g=a.height<=d?a.height:b.height*d;return{left:parseFloat(e-f)/2,top:parseFloat(d-g)/2,width:f,height:g}},f.cursorIsInside=function(a){var b=document.getElementById(a.getAttribute("id"));if(null==b)return!1;var c={};for(c.x=b.offsetLeft,c.y=b.offsetTop,c.dx=b.clientWidth,c.dy=b.clientHeight;b.offsetParent&&(c.x=c.x+b.offsetParent.offsetLeft,c.y=c.y+b.offsetParent.offsetTop-b.scrollTop,b!=document.getElementsByTagName("body")[0]);)b=b.offsetParent;var d=mouse.position.x>=c.x&&mouse.position.x<=c.x+c.dx&&mouse.position.y>=c.y&&mouse.position.y<=c.y+c.dy;return d},f.setToolbar=function(a){toolbar!=a&&(toolbar=a,a.renderInto(document.getElementById("toolbar")))},f.getBrowserName=function(){return enyo.platform.android?"Android":enyo.platform.androidChrome?"Chrome Android":enyo.platform.androidFirefox?"Firefox Android":enyo.platform.ie?"IE":enyo.platform.ios?"iOS":enyo.platform.webos?"webOS":enyo.platform.blackberry?"BlackBerry":enyo.platform.safari?"Safari":enyo.platform.chrome?"Chrome":enyo.platform.firefox?"Firefox":"Unknown"},f.getBrowserVersion=function(){return enyo.platform.android?enyo.platform.android:enyo.platform.androidChrome?enyo.platform.androidChrome:enyo.platform.androidFirefox?enyo.platform.androidFirefox:enyo.platform.ie?enyo.platform.ie:enyo.platform.ios?enyo.platform.ios:enyo.platform.webos?enyo.platform.webos:enyo.platform.blackberry?enyo.platform.blackberry:enyo.platform.safari?enyo.platform.safari:enyo.platform.chrome?enyo.platform.chrome:enyo.platform.firefox?enyo.platform.firefox:"?"},f.getClientType=function(){return"http"==document.location.protocol.substr(0,4)?constant.webAppType:constant.appType},f.getClientName=function(){return this.getClientType()==constant.webAppType?"Web App":"App"},f.getCurrentServerUrl=function(){var a=window.location.href.substr(document.location.protocol.length+2);return a.substring(0,a.lastIndexOf("/"))},f.restartApp=function(){location.reload()},f.vibrate=function(){(enyo.platform.android||enyo.platform.androidChrome||enyo.platform.ios)&&f.getClientType()==constant.appType&&navigator.vibrate&&navigator.vibrate(30)},f.hideNativeToolbar=function(){(enyo.platform.android||enyo.platform.androidChrome)&&f.getClientType()==constant.appType&&AndroidFullScreen.immersiveMode(function(){},function(){})},f.handleVolumeButtons=function(){if((enyo.platform.android||enyo.platform.androidChrome)&&f.getClientType()==constant.appType){var a=function(){};document.addEventListener("volumeupbutton",function(){cordova.plugins.VolumeControl.getVolume(function(b){var c=parseInt(b);c<100&&cordova.plugins.VolumeControl.setVolume(c+10,a,a)},a)},!1),document.addEventListener("volumedownbutton",function(){cordova.plugins.VolumeControl.getVolume(function(b){var c=parseInt(b);c>0&&cordova.plugins.VolumeControl.setVolume(c-1,a,a)},a)},!1)}},f.writeFile=function(a,b,c){var d=null,f=null,g="json",h=a.title,i="application/json";a&&a.mimetype?(i=a.mimetype,g="image/jpeg"==i?"jpg":"image/png"==i?"png":"audio/wav"==i?"wav":"video/webm"==i?"webm":"bin",d=e(b.substr(b.indexOf("base64,")+7)).buffer):f=JSON.stringify({metadata:a,text:b});var j=cordova.file.externalRootDirectory;enyo.platform.ios&&(j=cordova.file.documentsDirectory),window.resolveLocalFileSystemURL(j,function(a){a.getFile(h+"."+g,{create:!0},function(a){a&&a.createWriter(function(b){if(b.seek(b.length),f){var e=new Blob([f],{type:i});b.write(e)}else b.write(d);c(null,a.fullPath)},function(a){c(error.code,null)})})})},f.quitApp=function(){document.getElementById("toolbar").style.visibility="hidden",document.getElementById("canvas").style.visibility="hidden",document.getElementById("shutdown").style.visibility="visible","undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime&&window.top.postMessage("","*"),window.close(),/Edge/.test(navigator.userAgent)||(window.open("","_self",""),window.close()),navigator&&(navigator.app?navigator.app.exitApp():navigator.device&&navigator.device.exitApp())},f});