/*! Sugarizer 2018-05-08 */
function main(a,b,c,d,e,f,g){var h=new b({boardState:[],generation:0,playPauseIcon:"play",shouldPlay:!1}),i=c[0],j=(c[1],c[2],c[3]),k=document.querySelector(".main canvas"),l=new a(h.state.boardState,d.fill,"#FBF6F5",e(d.stroke,10),d.stroke,12,12,2,2,k);document.querySelector(".generation-count").style.color=d.fill,document.querySelector(".generation-status").style.color=d.fill,document.querySelector(".generation-status").innerText=f.get("Generation"),l.draw();var m=function(a){g.setDataAsText({boardState:a.boardState,generation:a.generation}),console.log("writing"),g.save(function(a){a?(console.log("writing failed."),console.error(a)):console.log("writing saved.")})},n=function a(){if(!h.state.shouldPlay)return 0;var b=h.state.boardState.map(function(a,b){return a.map(function(a,c){return o(a,p(c,b))})});h.set(function(a){return{boardState:b,generation:a.generation+1}}),setTimeout(a,100)},o=function(a,b){var c=1===a||2===a,d=b.filter(function(a){return 1===a||2===a}),e=d.length;return c?e<2?0:2===e||3===e?1:0:3===e?2:0},p=function(a,b){var c=a-1===-1?49:a-1,d=a+1===50?0:a+1,e=b-1===-1?29:b-1,f=b+1===30?0:b+1,g=h.state.boardState,i=g[b][c],j=g[b][d],k=g[e][a],l=g[f][a],m=g[e][c],n=g[f][c],o=g[e][d],p=g[f][d];return[i,j,k,l,m,n,o,p]};h.subscribe({boardState:[".fake-selector",function(a,b,c){l.update(b)}],generation:[".generation-count","innerText"],playPauseIcon:["#play-pause",function(a,b,c){a.className=b+" toolbutton"}],shouldPlay:[".fake-selector",function(a,b,c){b&&n()}]}),g.loadAsText(function(a,b,c){var d=c?c.boardState:i(),e=c?c.generation:0;h.set({boardState:d,generation:parseInt(e)})}),l.onClick(function(a,b){h.set(function(c){var d=[].concat(c.boardState),e=d[b][a];return 1===e||2===e?d[b][a]=0:d[b][a]=2,{boardState:d}})}),document.querySelector("#play-pause").addEventListener("click",function(){h.set(function(a){var b="play"===a.playPauseIcon?"pause":"play",c=a.shouldPlay!==!0;return a.shouldPlay&&m({boardState:h.state.boardState,generation:h.state.generation}),{playPauseIcon:b,shouldPlay:c}})}),document.querySelector("#stop-button").addEventListener("click",function(){m({boardState:h.state.boardState,generation:h.state.generation})}),document.querySelector("#random").addEventListener("click",function(){h.set({boardState:i(),generation:0})}),document.querySelector("#glider").addEventListener("click",function(){h.set({boardState:glider(),generation:0})}),document.querySelector("#no").addEventListener("click",function(){h.set({boardState:no(),generation:0})}),document.querySelector("#clear").addEventListener("click",function(){h.set({boardState:j(),generation:0,playPauseIcon:"play",shouldPlay:!1})}),window.addEventListener("resize",function(a){l.handleResize(window.innerWidth,h.state.boardState)}),l.handleResize(window.innerWidth,h.state.boardState)}define(["sugar-web/activity/activity","webL10n","activity/Board","activity/vanilla-state","activity/patterns","activity/shadeColor"],function(a,b,c,d,e,f){require(["domReady!"],function(g){a.setup(),window.addEventListener("localized",function(){a.getXOColor(function(g,h){var i=a.getDatastoreObject();main(c,d,e,h,f,b,i)})})})});