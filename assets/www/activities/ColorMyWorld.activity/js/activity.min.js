/*! Sugarizer 2018-06-12 */
define(["sugar-web/activity/activity","messages","print","activity/jquery-1.11.2.min","activity/ol","activity/hammer.min","l10n/l10n","config","colormyworld","map","roll_up_div","util","languagepalette","sugar-web/graphics/colorpalette","filterpalette","modepalette"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){require(["domReady!"],function(b){a.setup(),c(i.test()),c(j.test()),j.setup_map();var d=(document.webL10n.getLanguage(),document.getElementById("stop-button"));d.addEventListener("click",function(b){console.log("writing...");var c=a.getDatastoreObject(),d=i.saveStateCB();c.setDataAsText(d),c.save(function(a){null===a?console.log("write done."):console.log("write failed.")})});var e=window.onresize=function(){a.getDatastoreObject().getMetadata(function(b,c){var d=(new Date).getTime();if(Math.abs(d-c.creation_time)>=2e3){var e=a.getDatastoreObject();e.loadAsText(function(a,b,c){i.loadStateCB(c)})}});var b=document.webL10n.get("appname");"{{appname}}"==b&&(b="");var c=b.split(""),d=document.getElementById("persistent_title_div");html="";for(var e=0;e<c.length;e++){var f=i.mkBrightRGBA();html+="<span style='text-shadow:none;font-family:Mickey;color:"+f+";'>"+c[e]+"</span>"}d.innerHTML=html,l.resize()};window.setTimeout(e,1e3);var f=document.getElementById("run-button");f.onclick=function(){i.toggleRunning()},i.setRGBColorString("rgb(0, 150, 0)");var g=document.getElementById("color-button"),h=new n.ColorPalette(g);h.setColor(i.getRGBColorString()),h.addEventListener("colorChange",function(a){c(a.detail.color),i.setRGBColorString(a.detail.color)});var k=document.getElementById("mode-button");p=new p.ModePalette(k,void 0),i.change_areaCB(!0,"World")})});