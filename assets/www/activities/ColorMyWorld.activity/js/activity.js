/*! Sugarizer 2019-09-21 */
define(["sugar-web/activity/activity","messages","print","activity/jquery-1.11.2.min","activity/ol","activity/hammer.min","l10n/l10n","config","colormyworld","map","roll_up_div","util","languagepalette","sugar-web/graphics/colorpalette","filterpalette","modepalette"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){requirejs(["domReady!"],function(b){a.setup(),c(i.test()),c(j.test()),j.setup_map();document.webL10n.getLanguage();document.getElementById("stop-button").addEventListener("click",function(b){console.log("writing...");var c=a.getDatastoreObject(),d=i.saveStateCB();c.setDataAsText(d),c.save(function(a){null===a?console.log("write done."):console.log("write failed.")})});var d=window.onresize=function(){a.getDatastoreObject().getMetadata(function(b,c){var d=(new Date).getTime();if(Math.abs(d-c.creation_time)>=2e3){a.getDatastoreObject().loadAsText(function(a,b,c){i.loadStateCB(c)})}});var b=document.webL10n.get("appname");"{{appname}}"==b&&(b="");var c=b.split(""),d=document.getElementById("persistent_title_div");html="";for(var e=0;e<c.length;e++){var f=i.mkBrightRGBA();html+="<span style='text-shadow:none;font-family:Mickey;color:"+f+";'>"+c[e]+"</span>"}d.innerHTML=html,l.resize()};window.setTimeout(d,1e3),document.getElementById("run-button").onclick=function(){i.toggleRunning()},i.setRGBColorString("rgb(0, 150, 0)");var e=document.getElementById("color-button"),f=new n.ColorPalette(e);f.setColor(i.getRGBColorString()),f.addEventListener("colorChange",function(a){c(a.detail.color),i.setRGBColorString(a.detail.color)});var g=document.getElementById("mode-button");p=new p.ModePalette(g,void 0),i.change_areaCB(!0,"World")})});