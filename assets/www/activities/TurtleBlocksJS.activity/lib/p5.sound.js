/*! Sugarizer 2016-12-28 */
var sndcore;sndcore=function(){"use strict";window.AudioContext=window.AudioContext||window.webkitAudioContext;var a=null;try{a=new window.AudioContext}catch(a){return}p5.prototype.getAudioContext=function(){return a},"function"!=typeof a.createGain&&(window.audioContext.createGain=window.audioContext.createGainNode),"function"!=typeof a.createDelay&&(window.audioContext.createDelay=window.audioContext.createDelayNode),"function"!=typeof window.AudioBufferSourceNode.prototype.start&&(window.AudioBufferSourceNode.prototype.start=window.AudioBufferSourceNode.prototype.noteGrainOn),"function"!=typeof window.AudioBufferSourceNode.prototype.stop&&(window.AudioBufferSourceNode.prototype.stop=window.AudioBufferSourceNode.prototype.noteOff),"function"!=typeof window.OscillatorNode.prototype.start&&(window.OscillatorNode.prototype.start=window.OscillatorNode.prototype.noteOn),"function"!=typeof window.OscillatorNode.prototype.stop&&(window.OscillatorNode.prototype.stop=window.OscillatorNode.prototype.noteOff),window.AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(window.AudioContext.prototype.createScriptProcessor=window.AudioContext.prototype.createJavaScriptNode),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var b=document.createElement("audio");p5.prototype.isSupported=function(){return!!b.canPlayType};var c=function(){return!!b.canPlayType&&b.canPlayType('audio/ogg; codecs="vorbis"')},d=function(){return!!b.canPlayType&&b.canPlayType("audio/mpeg;")},e=function(){return!!b.canPlayType&&b.canPlayType('audio/wav; codecs="1"')},f=function(){return!!b.canPlayType&&(b.canPlayType("audio/x-m4a;")||b.canPlayType("audio/aac;"))},g=function(){return!!b.canPlayType&&b.canPlayType("audio/x-aiff;")};p5.prototype.isFileSupported=function(a){switch(a.toLowerCase()){case"mp3":return d();case"wav":return e();case"ogg":return c();case"mp4":return f();case"aiff":return g();default:return!1}};var h=!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g);h&&window.addEventListener("touchstart",function(){var b=a.createBuffer(1,1,22050),c=a.createBufferSource();c.buffer=b,c.connect(a.destination),c.start(0)},!1)}();var master;master=function(){"use strict";var a=function(){var a=p5.prototype.getAudioContext();this.input=a.createGain(),this.output=a.createGain(),this.limiter=a.createDynamicsCompressor(),this.limiter.threshold.value=0,this.limiter.ratio.value=100,this.audiocontext=a;try{this.output.disconnect(this.audiocontext.destination)}catch(a){}this.inputSources=[],this.input.connect(this.limiter),this.limiter.connect(this.output),this.meter=a.createGain(),this.output.connect(this.meter),this.output.connect(this.audiocontext.destination),this.soundArray=[],this.parts=[],this.extensions=[]},b=new a;return p5.soundOut=b,p5.soundOut._silentNode=b.audiocontext.createGain(),p5.soundOut._silentNode.gain.value=0,p5.soundOut._silentNode.connect(b.audiocontext.destination),b}(sndcore);var helpers;helpers=function(){"use strict";var a=master;p5.prototype.masterVolume=function(b){a.output.gain.value=b},p5.prototype.sampleRate=function(){return a.audiocontext.sampleRate},p5.prototype.getMasterVolume=function(){return a.output.gain.value},p5.prototype.freqToMidi=function(a){var b=Math.log(a/440)/Math.log(2),c=Math.round(12*b)+57;return c},p5.prototype.midiToFreq=function(a){return 440*Math.pow(2,(a-69)/12)},p5.prototype.soundFormats=function(){a.extensions=[];for(var b=0;b<arguments.length;b++){if(arguments[b]=arguments[b].toLowerCase(),!(["mp3","wav","ogg","m4a","aac"].indexOf(arguments[b])>-1))throw arguments[b]+" is not a valid sound format!";a.extensions.push(arguments[b])}},p5.prototype.disposeSound=function(){for(var b=0;b<a.soundArray.length;b++)a.soundArray[b].dispose()},p5.prototype.registerMethod("remove",p5.prototype.disposeSound),p5.prototype._checkFileFormats=function(b){var c;if("string"==typeof b){c=b;var d=c.split(".").pop();if(["mp3","wav","ogg","m4a","aac"].indexOf(d)>-1){var e=p5.prototype.isFileSupported(d);if(e)c=c;else for(var f=c.split("."),g=f[f.length-1],h=0;h<a.extensions.length;h++){var i=a.extensions[h],e=p5.prototype.isFileSupported(i);if(e){g="",2===f.length&&(g+=f[0]);for(var h=1;h<=f.length-2;h++){var j=f[h];g+="."+j}c=g+=".",c=c+=i;break}}}else for(var h=0;h<a.extensions.length;h++){var i=a.extensions[h],e=p5.prototype.isFileSupported(i);if(e){c=c+"."+i;break}}}else if("object"==typeof b)for(var h=0;h<b.length;h++){var i=b[h].split(".").pop(),e=p5.prototype.isFileSupported(i);if(e){c=b[h];break}}return c},p5.prototype._mathChain=function(a,b,c,d,e){for(var f in a.mathOps)a.mathOps[f]instanceof e&&(a.mathOps[f].dispose(),c=f,c<a.mathOps.length-1&&(d=a.mathOps[f+1]));return a.mathOps[c-1].disconnect(),a.mathOps[c-1].connect(b),b.connect(d),a.mathOps[c]=b,a}}(master);var panner;panner=function(){"use strict";var a=master,b=a.audiocontext;p5.Panner=function(a,c,d){this.input=b.createGain(),a.connect(this.input),this.left=b.createGain(),this.right=b.createGain(),this.left.channelInterpretation="discrete",this.right.channelInterpretation="discrete",d>1?(this.splitter=b.createChannelSplitter(2),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0)):(this.input.connect(this.left),this.input.connect(this.right)),this.output=b.createChannelMerger(2),this.left.connect(this.output,0,1),this.right.connect(this.output,0,0),this.output.connect(c)},p5.Panner.prototype.pan=function(a,c){var d=c||0,e=b.currentTime+d,f=(a+1)/2,g=Math.cos(f*Math.PI/2),h=Math.sin(f*Math.PI/2);this.left.gain.linearRampToValueAtTime(g,e),this.right.gain.linearRampToValueAtTime(h,e)},p5.Panner.prototype.inputChannels=function(a){1===a?(this.input.disconnect(),this.input.connect(this.left),this.input.connect(this.right)):2===a&&(this.splitter=b.createChannelSplitter(2),this.input.disconnect(),this.input.connect(this.splitter),this.splitter.connect(this.left,1),this.splitter.connect(this.right,0))},p5.Panner.prototype.connect=function(a){this.output.connect(a)},p5.Panner.prototype.disconnect=function(a){this.output.disconnect()},p5.Panner3D=function(a,c){var d=b.createPanner();return d.panningModel="HRTF",d.distanceModel="linear",d.setPosition(0,0,0),a.connect(d),d.connect(c),d.pan=function(a,b,c){d.setPosition(a,b,c)},d}}(master);var soundfile;soundfile=function(){"use strict";var a=master;p5.SoundFile=function(b,c,d){var e=p5.prototype._checkFileFormats(b);this.url=e,this.sources=[],this.source=null,this.buffer=null,this.playbackRate=1,this.gain=1,this.input=a.audiocontext.createGain(),this.output=a.audiocontext.createGain(),this.reversed=!1,this.startTime=0,this.endTime=null,this.playing=!1,this.paused=null,this.mode="sustain",this.startMillis=null,this.amplitude=new p5.Amplitude,this.output.connect(this.amplitude.input),this.panPosition=0,this.panner=new p5.Panner(this.output,a.input,2),this.url&&this.load(c),a.soundArray.push(this),"function"==typeof d?this.whileLoading=d:this.whileLoading=function(){}},p5.prototype.registerPreloadMethod("loadSound"),p5.prototype.loadSound=function(a,b,c){window.location.origin.indexOf("file://")>-1&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var d=new p5.SoundFile(a,b,c);return d},p5.SoundFile.prototype.load=function(a){var b=this,c=new XMLHttpRequest;c.addEventListener("progress",function(a){b._updateProgress(a)},!1),c.open("GET",this.url,!0),c.responseType="arraybuffer";var d=this;c.onload=function(){var b=p5.prototype.getAudioContext();b.decodeAudioData(c.response,function(b){d.buffer=b,d.panner.inputChannels(b.numberOfChannels),a&&a(d)})},c.send()},p5.SoundFile.prototype._updateProgress=function(a){if(a.lengthComputable){var b=Math.log(a.loaded/a.total*9.9);this.whileLoading(b)}else console.log("size unknown")},p5.SoundFile.prototype.isLoaded=function(){return!!this.buffer},p5.SoundFile.prototype.play=function(b,c,d,e,f){var g=a.audiocontext.currentTime,b=b||0;if(b<0&&(b=0),!this.buffer)throw"not ready to play file, buffer has yet to load. Try preload()";if("restart"===this.mode&&this.buffer&&this.source){var g=a.audiocontext.currentTime;this.source.stop(b)}if(e){if(!(e>=0&&e<this.buffer.duration))throw"start time out of range";this.startTime=e}if(f){if(!(f>=0&&f<=this.buffer.duration))throw"end time out of range";this.endTime=f}else this.endTime=this.buffer.duration;if(this.source=a.audiocontext.createBufferSource(),this.source.buffer=this.buffer,this.source.loop=this.looping,this.source.loop===!0&&(this.source.loopStart=this.startTime,this.source.loopEnd=this.endTime),this.source.onended=function(){},this.source.gain)this.source.gain.value=d||1,this.source.connect(this.output);else{this.source.gain=a.audiocontext.createGain(),this.source.connect(this.source.gain);var h=d||1;this.source.gain.gain.setValueAtTime(h,a.audiocontext.currentTime),this.source.gain.connect(this.output)}this.source.playbackRate.cancelScheduledValues(g),c=c||Math.abs(this.playbackRate),this.source.playbackRate.setValueAtTime(c,g),this.paused&&(this.wasUnpaused=!0),this.paused&&this.wasUnpaused?this.source.start(b,this.pauseTime,this.endTime):(this.wasUnpaused=!1,this.pauseTime=0,this.source.start(b,this.startTime,this.endTime)),this.startSeconds=b+g,this.playing=!0,this.paused=!1,this.sources.push(this.source)},p5.SoundFile.prototype.playMode=function(b){var c=b.toLowerCase();if("restart"===c&&this.buffer&&this.source)for(var d=0;d<this.sources.length-1;d++){var e=a.audiocontext.currentTime;this.sources[d].stop(e)}if("restart"!==c&&"sustain"!==c)throw'Invalid play mode. Must be either "restart" or "sustain"';this.mode=c},p5.SoundFile.prototype.pause=function(b){var c=a.audiocontext.currentTime,b=b||0,d=b+c;this.looping;this.isPlaying()&&this.buffer&&this.source&&(this.pauseTime=this.currentTime(),this.source.stop(d),this.paused=!0,this.wasUnpaused=!1,this.playing=!1)},p5.SoundFile.prototype.loop=function(a,b,c,d){this.looping=!0,this.play(a,b,c,d)},p5.SoundFile.prototype.setLoop=function(a){if(a===!0)this.looping=!0;else{if(a!==!1)throw"Error: setLoop accepts either true or false";this.looping=!1}this.source&&(this.source.loop=this.looping)},p5.SoundFile.prototype.isLooping=function(){return!!this.source&&(this.looping===!0&&this.isPlaying()===!0)},p5.SoundFile.prototype.isPlaying=function(){return null!==this.playing&&this.playing},p5.SoundFile.prototype.isPaused=function(){return!!this.paused&&this.paused},p5.SoundFile.prototype.stop=function(){if("sustain"==this.mode)this.stopAll(),this.playing=!1,this.pauseTime=0,this.wasUnpaused=!1,this.paused=!1;else if(this.buffer&&this.source){var b=a.audiocontext.currentTime;this.source.stop(b),this.playing=!1,this.pauseTime=0,this.wasUnpaused=!1,this.paused=!1}},p5.SoundFile.prototype.stopAll=function(){if(this.buffer&&this.source)for(var b=0;b<this.sources.length;b++)if(null!==this.sources[b]){var c=a.audiocontext.currentTime;this.sources[b].stop(c)}},p5.SoundFile.prototype.setVolume=function(b,c,d){if("number"==typeof b){var c=c||0,d=d||0,e=a.audiocontext.currentTime,f=this.output.gain.value;this.output.gain.cancelScheduledValues(e+d),this.output.gain.linearRampToValueAtTime(f,e+d),this.output.gain.linearRampToValueAtTime(b,e+d+c)}else{if(!b)return this.output.gain;b.connect(this.output.gain)}},p5.SoundFile.prototype.amp=p5.SoundFile.prototype.setVolume,p5.SoundFile.prototype.fade=p5.SoundFile.prototype.setVolume,p5.SoundFile.prototype.getVolume=function(){return this.output.gain.value},p5.SoundFile.prototype.pan=function(a,b){this.panPosition=a,this.panner.pan(a,b)},p5.SoundFile.prototype.getPan=function(){return this.panPosition},p5.SoundFile.prototype.rate=function(b){if(this.playbackRate!==b||!this.source||this.source.playbackRate.value!==b){this.playbackRate=b;var c=b;if(0===this.playbackRate&&this.playing&&this.pause(),this.playbackRate<0&&!this.reversed){var d=this.currentTime();this.source.playbackRate.value;this.reverseBuffer(),c=Math.abs(b);var e=(d-this.duration())/c;this.pauseTime=e}else this.playbackRate>0&&this.reversed&&this.reverseBuffer();if(this.source){var f=a.audiocontext.currentTime;this.source.playbackRate.cancelScheduledValues(f),this.source.playbackRate.linearRampToValueAtTime(Math.abs(c),f)}}},p5.SoundFile.prototype.getPlaybackRate=function(){return this.playbackRate},p5.SoundFile.prototype.duration=function(){return this.buffer?this.buffer.duration:0},p5.SoundFile.prototype.currentTime=function(){var b;if(this.isPlaying()){var c=a.audiocontext.currentTime-this.startSeconds+this.startTime+this.pauseTime;return b=c*this.playbackRate%(this.duration()*this.playbackRate),console.log("1"),b}return this.paused?this.pauseTime:this.startTime},p5.SoundFile.prototype.jump=function(b,c){if(b<0||b>this.buffer.duration)throw"jump time out of range";if(c<b||c>this.buffer.duration)throw"end time out of range";if(this.startTime=b||0,c?this.endTime=c:this.endTime=this.buffer.duration,this.isPlaying()){var d=a.audiocontext.currentTime;this.stop(d),this.play(b,this.endTime)}},p5.SoundFile.prototype.channels=function(){return this.buffer.numberOfChannels},p5.SoundFile.prototype.sampleRate=function(){return this.buffer.sampleRate},p5.SoundFile.prototype.frames=function(){return this.buffer.length},p5.SoundFile.prototype.getPeaks=function(a){if(!this.buffer)throw"Cannot load peaks yet, buffer is not loaded";if(a||(a=5*window.width),this.buffer){for(var b=this.buffer,c=b.length/a,d=~~(c/10)||1,e=b.numberOfChannels,f=new Float32Array(Math.round(a)),g=0;g<e;g++)for(var h=b.getChannelData(g),i=0;i<a;i++){for(var j=~~(i*c),k=~~(j+c),l=0,m=j;m<k;m+=d){var n=h[m];n>l?l=n:-n>l&&(l=n)}(0===g||l>f[i])&&(f[i]=l)}return f}},p5.SoundFile.prototype.reverseBuffer=function(){var a=this.getVolume();if(this.setVolume(0,.01,0),this.pause(),!this.buffer)throw"SoundFile is not done loading";Array.prototype.reverse.call(this.buffer.getChannelData(0)),Array.prototype.reverse.call(this.buffer.getChannelData(1)),this.reversed=!this.reversed,this.setVolume(a,.01,.0101),this.play()},p5.SoundFile.prototype._onEnded=function(b){b.onended=function(b){var c=a.audiocontext.currentTime;b.stop(c)}},p5.SoundFile.prototype.add=function(){},p5.SoundFile.prototype.dispose=function(){if(this.buffer&&this.source)for(var b=0;b<this.sources.length-1;b++)if(null!==this.sources[b]){var c=a.audiocontext.currentTime;this.sources[b].stop(c),this.sources[b]=null}this.output&&(this.output.disconnect(),this.output=null),this.panner&&(this.panner.disconnect(),this.panner=null)},p5.SoundFile.prototype.connect=function(b){b?b.hasOwnProperty("input")?this.panner.connect(b.input):this.panner.connect(b):this.panner.connect(a.input)},p5.SoundFile.prototype.disconnect=function(a){this.panner.disconnect(a)},p5.SoundFile.prototype.getLevel=function(a){return a&&(this.amplitude.smoothing=a),this.amplitude.getLevel()},p5.SoundFile.prototype.setPath=function(a,b){var c=p5.prototype._checkFileFormats(a);this.url=c,this.load(b)},p5.SoundFile.prototype.setBuffer=function(b){for(var c=a.audiocontext,d=c.createBuffer(2,b[0].length,c.sampleRate),e=0,f=0;f<b.length;f++){var g=d.getChannelData(f);g.set(b[f]),e++}this.buffer=d,this.panner.inputChannels(e)}}(sndcore,master);var amplitude;amplitude=function(){"use strict";var a=master;p5.Amplitude=function(b){this.bufferSize=2048,this.audiocontext=a.audiocontext,this.processor=this.audiocontext.createScriptProcessor(this.bufferSize),this.input=this.processor,this.output=this.audiocontext.createGain(),this.smoothing=b||0,this.volume=0,this.average=0,this.volMax=.001,this.normalize=!1,this.processor.onaudioprocess=this.volumeAudioProcess.bind(this),this.processor.connect(this.output),this.output.gain.value=0,this.output.connect(this.audiocontext.destination),a.meter.connect(this.processor)},p5.Amplitude.prototype.setInput=function(b,c){a.meter.disconnect(this.processor),c&&(this.smoothing=c),null==b?(console.log("Amplitude input source is not ready! Connecting to master output instead"),a.meter.connect(this.processor)):b instanceof p5.Signal?b.output.connect(this.processor):b?(b.connect(this.processor),this.processor.disconnect(),this.processor.connect(this.output)):a.meter.connect(this.processor)},p5.Amplitude.prototype.connect=function(b){b?b.hasOwnProperty("input")?this.output.connect(b.input):this.output.connect(b):this.output.connect(this.panner.connect(a.input))},p5.Amplitude.prototype.disconnect=function(a){this.output.disconnect()},p5.Amplitude.prototype.volumeAudioProcess=function(a){for(var b,c=a.inputBuffer.getChannelData(0),d=c.length,e=0,f=0,g=0;g<d;g++)b=c[g],this.normalize?(e+=Math.max(Math.min(b/this.volMax,1),-1),f+=Math.max(Math.min(b/this.volMax,1),-1)*Math.max(Math.min(b/this.volMax,1),-1)):(e+=b,f+=b*b);var h=Math.sqrt(f/d);this.volume=Math.max(h,this.volume*this.smoothing),this.volMax=Math.max(this.volume,this.volMax),this.volNorm=Math.max(Math.min(this.volume/this.volMax,1),0)},p5.Amplitude.prototype.getLevel=function(){return this.normalize?this.volNorm:this.volume},p5.Amplitude.prototype.toggleNormalize=function(a){"boolean"==typeof a?this.normalize=a:this.normalize=!this.normalize},p5.Amplitude.prototype.smooth=function(a){a>=0&&a<1?this.smoothing=a:console.log("Error: smoothing must be between 0 and 1")}}(master);var fft;fft=function(){"use strict";var a=master;p5.FFT=function(b,c){var d=b||.8;0===b&&(d=b);var e=2*c||2048;this.analyser=a.audiocontext.createAnalyser(),a.output.connect(this.analyser),this.analyser.smoothingTimeConstant=d,this.analyser.fftSize=e,this.freqDomain=new Uint8Array(this.analyser.frequencyBinCount),this.timeDomain=new Uint8Array(this.analyser.frequencyBinCount),this.bass=[20,140],this.lowMid=[140,400],this.mid=[400,2600],this.highMid=[2600,5200],this.treble=[5200,14e3]},p5.FFT.prototype.setInput=function(a,b){b&&(this.analyser.fftSize=2*b),a.output?a.output.connect(this.analyser):a.connect(this.analyser)},p5.FFT.prototype.waveform=function(a){a&&(this.analyser.fftSize=2*a),this.analyser.getByteTimeDomainData(this.timeDomain);var b=Array.apply([],this.timeDomain);return b.length===this.analyser.fftSize,b.constructor===Array,b},p5.FFT.prototype.analyze=function(a){a&&(this.analyser.fftSize=2*a),this.analyser.getByteFrequencyData(this.freqDomain);var b=Array.apply([],this.freqDomain);return b.length===this.analyser.fftSize,b.constructor===Array,b},p5.FFT.prototype.getEnergy=function(b,c){var d=a.audiocontext.sampleRate/2;if("bass"===b?(b=this.bass[0],c=this.bass[1]):"lowMid"===b?(b=this.lowMid[0],c=this.lowMid[1]):"mid"===b?(b=this.mid[0],c=this.mid[1]):"highMid"===b?(b=this.highMid[0],c=this.highMid[1]):"treble"===b&&(b=this.treble[0],c=this.treble[1]),"number"!=typeof b)throw"invalid input for getEnergy()";if(c){if(b&&c){if(b>c){var e=c;c=b,b=e}for(var f=Math.round(b/d*this.freqDomain.length),g=Math.round(c/d*this.freqDomain.length),h=0,i=0,j=f;j<=g;j++)h+=this.freqDomain[j],i+=1;var k=h/i;return k}throw"invalid input for getEnergy()"}var l=Math.round(b/d*this.freqDomain.length);return this.freqDomain[l]},p5.FFT.prototype.getFreq=function(a,b){console.log("getFreq() is deprecated. Please use getEnergy() instead.");var c=this.getEnergy(a,b);return c},p5.FFT.prototype.smooth=function(a){this.analyser.smoothingTimeConstant=a}}(master);var Tone_core_Tone;Tone_core_Tone=function(){"use strict";function a(a){return void 0===a}var b;if(a(window.AudioContext)&&(window.AudioContext=window.webkitAudioContext),a(window.OfflineAudioContext)&&(window.OfflineAudioContext=window.webkitOfflineAudioContext),a(AudioContext))throw new Error("Web Audio is not supported in this browser");b=new AudioContext,"function"!=typeof AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),"function"!=typeof AudioContext.prototype.createDelay&&(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),"function"!=typeof AudioContext.prototype.createPeriodicWave&&(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),"function"!=typeof AudioBufferSourceNode.prototype.start&&(AudioBufferSourceNode.prototype.start=AudioBufferSourceNode.prototype.noteGrainOn),"function"!=typeof AudioBufferSourceNode.prototype.stop&&(AudioBufferSourceNode.prototype.stop=AudioBufferSourceNode.prototype.noteOff),"function"!=typeof OscillatorNode.prototype.start&&(OscillatorNode.prototype.start=OscillatorNode.prototype.noteOn),"function"!=typeof OscillatorNode.prototype.stop&&(OscillatorNode.prototype.stop=OscillatorNode.prototype.noteOff),"function"!=typeof OscillatorNode.prototype.setPeriodicWave&&(OscillatorNode.prototype.setPeriodicWave=OscillatorNode.prototype.setWaveTable),AudioNode.prototype._nativeConnect=AudioNode.prototype.connect,AudioNode.prototype.connect=function(b,c,d){if(b.input)Array.isArray(b.input)?(a(d)&&(d=0),this.connect(b.input[d])):this.connect(b.input,c,d);else try{b instanceof AudioNode?this._nativeConnect(b,c,d):this._nativeConnect(b,c)}catch(a){throw new Error("error connecting to node: "+b)}};var c=function(b,c){a(b)||1===b?this.input=this.context.createGain():b>1&&(this.input=new Array(b)),a(c)||1===c?this.output=this.context.createGain():c>1&&(this.output=new Array(b))};c.context=b,c.prototype.context=c.context,c.prototype.bufferSize=2048,c.prototype.bufferTime=c.prototype.bufferSize/c.context.sampleRate,c.prototype.connect=function(a,b,c){Array.isArray(this.output)?(b=this.defaultArg(b,0),this.output[b].connect(a,0,c)):this.output.connect(a,b,c)},c.prototype.disconnect=function(a){Array.isArray(this.output)?(a=this.defaultArg(a,0),this.output[a].disconnect()):this.output.disconnect()},c.prototype.connectSeries=function(){if(arguments.length>1)for(var a=arguments[0],b=1;b<arguments.length;b++){var c=arguments[b];a.connect(c),a=c}},c.prototype.connectParallel=function(){var a=arguments[0];if(arguments.length>1)for(var b=1;b<arguments.length;b++){var c=arguments[b];a.connect(c)}},c.prototype.chain=function(){if(arguments.length>0)for(var a=this,b=0;b<arguments.length;b++){var c=arguments[b];a.connect(c),a=c}},c.prototype.fan=function(){if(arguments.length>0)for(var a=1;a<arguments.length;a++)this.connect(arguments[a])},AudioNode.prototype.chain=c.prototype.chain,AudioNode.prototype.fan=c.prototype.fan,c.prototype.defaultArg=function(b,c){if("object"==typeof b&&"object"==typeof c){var d={};for(var e in b)d[e]=this.defaultArg(b[e],b[e]);for(var f in c)d[f]=this.defaultArg(b[f],c[f]);return d}return a(b)?c:b},c.prototype.optionsObject=function(a,b,c){var d={};if(1===a.length&&"object"==typeof a[0])d=a[0];else for(var e=0;e<b.length;e++)d[b[e]]=a[e];return this.isUndef(c)?d:this.defaultArg(d,c)},c.prototype.isUndef=a,c.prototype.equalPowerScale=function(a){var b=.5*Math.PI;return Math.sin(a*b)},c.prototype.logScale=function(a){return Math.max(this.normalize(this.gainToDb(a),-100,0),0)},c.prototype.expScale=function(a){return this.dbToGain(this.interpolate(a,-100,0))},c.prototype.dbToGain=function(a){return Math.pow(2,a/6)},c.prototype.gainToDb=function(a){return 20*(Math.log(a)/Math.LN10)},c.prototype.interpolate=function(a,b,c){return a*(c-b)+b},c.prototype.normalize=function(a,b,c){if(b>c){var d=c;c=b,b=d}else if(b==c)return 0;return(a-b)/(c-b)},c.prototype.dispose=function(){this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null)};var d=null;c.prototype.noGC=function(){this.output.connect(d)},AudioNode.prototype.noGC=function(){this.connect(d)},c.prototype.now=function(){return this.context.currentTime},c.prototype.samplesToSeconds=function(a){return a/this.context.sampleRate},c.prototype.toSamples=function(a){var b=this.toSeconds(a);return Math.round(b*this.context.sampleRate)},c.prototype.toSeconds=function(a,b){if(b=this.defaultArg(b,this.now()),"number"==typeof a)return a;if("string"==typeof a){var c=0;return"+"===a.charAt(0)&&(a=a.slice(1),c=b),parseFloat(a)+c}return b},c.prototype.frequencyToSeconds=function(a){return 1/parseFloat(a)},c.prototype.secondsToFrequency=function(a){return 1/a};var e=[];return c._initAudioContext=function(a){a(c.context),e.push(a)},c.setContext=function(a){c.prototype.context=a,c.context=a;for(var b=0;b<e.length;b++)e[b](a)},c.extend=function(b,d){function e(){}a(d)&&(d=c),e.prototype=d.prototype,b.prototype=new e,b.prototype.constructor=b},c.startMobile=function(){var a=c.context.createOscillator(),b=c.context.createGain();b.gain.value=0,a.connect(b),b.connect(c.context.destination);var d=c.context.currentTime;a.start(d),a.stop(d+1)},c._initAudioContext(function(a){c.prototype.bufferTime=c.prototype.bufferSize/a.sampleRate,d=a.createGain(),d.gain.value=0,d.connect(a.destination)}),c}();var Tone_signal_SignalBase;Tone_signal_SignalBase=function(a){"use strict";return a.SignalBase=function(){},a.extend(a.SignalBase),a.SignalBase.prototype.connect=function(b,c,d){b instanceof a.Signal?b.setValue(0):b instanceof AudioParam&&(b.value=0),a.prototype.connect.call(this,b,c,d)},a.SignalBase.prototype.dispose=function(){a.prototype.dispose.call(this)},a.SignalBase}(Tone_core_Tone);var Tone_signal_WaveShaper;Tone_signal_WaveShaper=function(a){"use strict";return a.WaveShaper=function(a,b){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(a)?this.setCurve(a):isFinite(a)||this.isUndef(a)?this._curve=new Float32Array(this.defaultArg(a,1024)):"function"==typeof a&&(this._curve=new Float32Array(this.defaultArg(b,1024)),this.setMap(a))},a.extend(a.WaveShaper,a.SignalBase),a.WaveShaper.prototype.setMap=function(a){for(var b=0,c=this._curve.length;b<c;b++){var d=b/c*2-1,e=b/(c-1)*2-1;this._curve[b]=a(d,b,e)}this._shaper.curve=this._curve},a.WaveShaper.prototype.setCurve=function(a){if(this._isSafari()){var b=a[0];a.unshift(b)}this._curve=new Float32Array(a),this._shaper.curve=this._curve},a.WaveShaper.prototype.setOversample=function(a){this._shaper.oversample=a},a.WaveShaper.prototype._isSafari=function(){var a=navigator.userAgent.toLowerCase();return a.indexOf("safari")!==-1&&a.indexOf("chrome")===-1},a.WaveShaper.prototype.dispose=function(){a.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null},a.WaveShaper}(Tone_core_Tone);var Tone_signal_Signal;Tone_signal_Signal=function(a){"use strict";return a.Signal=function(b){this._scalar=this.context.createGain(),this.input=this.output=this.context.createGain(),this._syncRatio=1,this.value=this.defaultArg(b,0),a.Signal._constant.chain(this._scalar,this.output)},a.extend(a.Signal,a.SignalBase),a.Signal.prototype.getValue=function(){return this._scalar.gain.value},a.Signal.prototype.setValue=function(a){0===this._syncRatio?a=0:a*=this._syncRatio,this._scalar.gain.value=a},a.Signal.prototype.setValueAtTime=function(a,b){a*=this._syncRatio,this._scalar.gain.setValueAtTime(a,this.toSeconds(b))},a.Signal.prototype.setCurrentValueNow=function(a){a=this.defaultArg(a,this.now());var b=this.getValue();return this.cancelScheduledValues(a),this._scalar.gain.setValueAtTime(b,a),b},a.Signal.prototype.linearRampToValueAtTime=function(a,b){a*=this._syncRatio,this._scalar.gain.linearRampToValueAtTime(a,this.toSeconds(b))},a.Signal.prototype.exponentialRampToValueAtTime=function(a,b){a*=this._syncRatio;try{this._scalar.gain.exponentialRampToValueAtTime(a,this.toSeconds(b))}catch(c){this._scalar.gain.linearRampToValueAtTime(a,this.toSeconds(b))}},a.Signal.prototype.exponentialRampToValueNow=function(a,b){var c=this.now();this.setCurrentValueNow(c),"+"===b.toString().charAt(0)&&(b=b.substr(1)),this.exponentialRampToValueAtTime(a,c+this.toSeconds(b))},a.Signal.prototype.linearRampToValueNow=function(a,b){var c=this.now();this.setCurrentValueNow(c),a*=this._syncRatio,"+"===b.toString().charAt(0)&&(b=b.substr(1)),this._scalar.gain.linearRampToValueAtTime(a,c+this.toSeconds(b))},a.Signal.prototype.setTargetAtTime=function(a,b,c){a*=this._syncRatio,this._scalar.gain.setTargetAtTime(a,this.toSeconds(b),c)},a.Signal.prototype.setValueCurveAtTime=function(a,b,c){for(var d=0;d<a.length;d++)a[d]*=this._syncRatio;this._scalar.gain.setValueCurveAtTime(a,this.toSeconds(b),this.toSeconds(c))},a.Signal.prototype.cancelScheduledValues=function(a){this._scalar.gain.cancelScheduledValues(this.toSeconds(a))},a.Signal.prototype.sync=function(a,b){b?this._syncRatio=b:0!==a.getValue()?this._syncRatio=this.getValue()/a.getValue():this._syncRatio=0,this._scalar.disconnect(),this._scalar=this.context.createGain(),this.connectSeries(a,this._scalar,this.output),this._scalar.gain.value=this._syncRatio},a.Signal.prototype.unsync=function(){var b=this.getValue();this._scalar.disconnect(),this._scalar=this.context.createGain(),this._scalar.gain.value=b/this._syncRatio,this._syncRatio=1,a.Signal._constant.chain(this._scalar,this.output)},a.Signal.prototype.dispose=function(){a.prototype.dispose.call(this),this._scalar.disconnect(),this._scalar=null},Object.defineProperty(a.Signal.prototype,"value",{get:function(){return this.getValue()},set:function(a){this.setValue(a)}}),a.Signal._generator=null,a.Signal._constant=null,a._initAudioContext(function(b){a.Signal._generator=b.createOscillator(),a.Signal._constant=new a.WaveShaper([1,1]),a.Signal._generator.connect(a.Signal._constant),a.Signal._generator.start(0),a.Signal._generator.noGC()}),a.Signal}(Tone_core_Tone);var Tone_signal_Add;Tone_signal_Add=function(a){"use strict";return a.Add=function(b){a.call(this,2,0),this._sum=this.input[0]=this.input[1]=this.output=this.context.createGain(),this._value=null,isFinite(b)&&(this._value=new a.Signal(b),this._value.connect(this._sum))},a.extend(a.Add,a.SignalBase),a.Add.prototype.setValue=function(a){if(null===this._value)throw new Error("cannot switch from signal to number");this._value.setValue(a)},a.Add.prototype.dispose=function(){a.prototype.dispose.call(this),this._sum=null,this._value&&(this._value.dispose(),this._value=null)},a.Add}(Tone_core_Tone);var Tone_signal_Multiply;Tone_signal_Multiply=function(a){"use strict";return a.Multiply=function(b){a.call(this,2,0),this._mult=this.input[0]=this.output=this.context.createGain(),this._factor=this.input[1]=this.output.gain,this._factor.value=this.defaultArg(b,0)},a.extend(a.Multiply,a.SignalBase),a.Multiply.prototype.setValue=function(a){this._factor.value=a},a.Multiply.prototype.dispose=function(){a.prototype.dispose.call(this),this._mult=null,this._factor=null},a.Multiply}(Tone_core_Tone);var Tone_signal_Scale;Tone_signal_Scale=function(a){"use strict";return a.Scale=function(b,c){this._outputMin=this.defaultArg(b,0),this._outputMax=this.defaultArg(c,1),this._scale=this.input=new a.Multiply(1),this._add=this.output=new a.Add(0),this._scale.connect(this._add),this._setRange()},a.extend(a.Scale,a.SignalBase),a.Scale.prototype.setMin=function(a){this._outputMin=a,this._setRange()},a.Scale.prototype.setMax=function(a){this._outputMax=a,this._setRange()},a.Scale.prototype._setRange=function(){this._add.setValue(this._outputMin),this._scale.setValue(this._outputMax-this._outputMin)},a.Scale.prototype.dispose=function(){a.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null},a.Scale}(Tone_core_Tone,Tone_signal_Add,Tone_signal_Multiply);var signal;signal=function(){"use strict";var a=Tone_signal_Signal,b=Tone_signal_Add,c=Tone_signal_Multiply,d=Tone_signal_Scale,e=Tone_core_Tone,f=master;e.setContext(f.audiocontext),p5.Signal=function(b){var c=new a(b);return c},a.prototype.fade=a.prototype.linearRampToValueAtTime,c.prototype.fade=a.prototype.fade,b.prototype.fade=a.prototype.fade,d.prototype.fade=a.prototype.fade,a.prototype.setInput=function(a){a.connect(this)},c.prototype.setInput=a.prototype.setInput,b.prototype.setInput=a.prototype.setInput,d.prototype.setInput=a.prototype.setInput,a.prototype.add=function(a){var c=new b(a);return this.connect(c),c},c.prototype.add=a.prototype.add,b.prototype.add=a.prototype.add,d.prototype.add=a.prototype.add,
a.prototype.mult=function(a){var b=new c(a);return this.connect(b),b},c.prototype.mult=a.prototype.mult,b.prototype.mult=a.prototype.mult,d.prototype.mult=a.prototype.mult,a.prototype.scale=function(a,b,c,e){var f,g;4===arguments.length?(f=p5.prototype.map(c,a,b,0,1)-.5,g=p5.prototype.map(e,a,b,0,1)-.5):(f=arguments[0],g=arguments[1]);var h=new d(f,g);return this.connect(h),h},c.prototype.scale=a.prototype.scale,b.prototype.scale=a.prototype.scale,d.prototype.scale=a.prototype.scale}(Tone_signal_Signal,Tone_signal_Add,Tone_signal_Multiply,Tone_signal_Scale,Tone_core_Tone,master);var oscillator;oscillator=function(){"use strict";var a=master,b=Tone_signal_Add,c=Tone_signal_Multiply,d=Tone_signal_Scale;p5.Oscillator=function(b,c){if("string"==typeof b){var d=c;c=b,b=d}if("number"==typeof c){var d=c;c=b,b=d}this.started=!1,this.oscillator=a.audiocontext.createOscillator(),this.f=b||440,this.oscillator.frequency.setValueAtTime(this.f,a.audiocontext.currentTime),this.oscillator.type=c||"sine";this.oscillator;this.input=a.audiocontext.createGain(),this.output=a.audiocontext.createGain(),this._freqMods=[],this.output.gain.value=.5,this.output.gain.setValueAtTime(.5,a.audiocontext.currentTime),this.oscillator.connect(this.output),this.panPosition=0,this.connection=a.input,this.panner=new p5.Panner(this.output,this.connection,1),this.mathOps=[this.output],a.soundArray.push(this)},p5.Oscillator.prototype.start=function(b,c){if(this.started){var d=a.audiocontext.currentTime;this.stop(d)}if(!this.started){var e=c||this.f,f=this.oscillator.type;this.oscillator=a.audiocontext.createOscillator(),this.oscillator.frequency.exponentialRampToValueAtTime(Math.abs(e),a.audiocontext.currentTime),this.oscillator.type=f,this.oscillator.connect(this.output),b=b||0,this.oscillator.start(b+a.audiocontext.currentTime),this.freqNode=this.oscillator.frequency;for(var g in this._freqMods)"undefined"!=typeof this._freqMods[g].connect&&this._freqMods[g].connect(this.oscillator.frequency);this.started=!0}},p5.Oscillator.prototype.stop=function(b){if(this.started){var c=b||0,d=a.audiocontext.currentTime;this.oscillator.stop(c+d),this.started=!1}},p5.Oscillator.prototype.amp=function(b,c,d){var e=this;if("number"==typeof b){var c=c||0,d=d||0,f=a.audiocontext.currentTime,g=this.output.gain.value;this.output.gain.cancelScheduledValues(f),this.output.gain.linearRampToValueAtTime(g,f+d),this.output.gain.linearRampToValueAtTime(b,f+d+c)}else{if(!b)return this.output.gain;console.log(b),b.connect(e.output.gain)}},p5.Oscillator.prototype.fade=p5.Oscillator.prototype.amp,p5.Oscillator.prototype.getAmp=function(){return this.output.gain.value},p5.Oscillator.prototype.freq=function(b,c,d){if("number"!=typeof b||isNaN(b)){if(!b)return this.oscillator.frequency;b.output&&(b=b.output),b.connect(this.oscillator.frequency),this._freqMods.push(b)}else{this.f=b;var e=a.audiocontext.currentTime,c=c||0,d=d||0,f=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(e),this.oscillator.frequency.setValueAtTime(f,e+d),b>0?this.oscillator.frequency.exponentialRampToValueAtTime(b,d+c+e):this.oscillator.frequency.linearRampToValueAtTime(b,d+c+e)}},p5.Oscillator.prototype.getFreq=function(){return this.oscillator.frequency.value},p5.Oscillator.prototype.setType=function(a){this.oscillator.type=a},p5.Oscillator.prototype.getType=function(){return this.oscillator.type},p5.Oscillator.prototype.connect=function(b){b?b.hasOwnProperty("input")?(this.panner.connect(b.input),this.connection=b.input):(this.panner.connect(b),this.connection=b):this.panner.connect(a.input)},p5.Oscillator.prototype.disconnect=function(a){this.output.disconnect(),this.panner.disconnect(),this.output.connect(this.panner),this.oscMods=[]},p5.Oscillator.prototype.pan=function(a,b){this.panPosition=a,this.panner.pan(a,b)},p5.Oscillator.prototype.getPan=function(){return this.panPosition},p5.Oscillator.prototype.dispose=function(){if(this.oscillator){var b=a.audiocontext.currentTime;this.stop(b),this.disconnect(),this.oscillator.disconnect(),this.panner=null,this.oscillator=null}this.osc2&&this.osc2.dispose()},p5.Oscillator.prototype.phase=function(b){this.dNode||(this.dNode=a.audiocontext.createDelay(),this.output.disconnect(),this.output.connect(this.dNode),this.dNode.connect(this.panner));var c=a.audiocontext.currentTime;this.dNode.delayTime.linearRampToValueAtTime(p5.prototype.map(b,0,1,0,1/this.oscillator.frequency.value),c)};var e=function(a,b,c,d,e){var f=a.oscillator;for(var g in a.mathOps)a.mathOps[g]instanceof e&&(f.disconnect(),a.mathOps[g].dispose(),c=g,c<a.mathOps.length-2&&(d=a.mathOps[g+1]));return c==a.mathOps.length-1&&a.mathOps.push(d),g>0&&(f=a.mathOps[g-1]),f.disconnect(),f.connect(b),b.connect(d),a.mathOps[c]=b,a};p5.Oscillator.prototype.add=function(a){var c=new b(a),d=this.mathOps.length-1,f=this.output;return e(this,c,d,f,b)},p5.Oscillator.prototype.mult=function(a){var b=new c(a),d=this.mathOps.length-1,f=this.output;return e(this,b,d,f,c)},p5.Oscillator.prototype.scale=function(a,b,c,f){var g,h;4===arguments.length?(g=p5.prototype.map(c,a,b,0,1)-.5,h=p5.prototype.map(f,a,b,0,1)-.5):(g=arguments[0],h=arguments[1]);var i=new d(g,h),j=this.mathOps.length-1,k=this.output;return e(this,i,j,k,d)},p5.SinOsc=function(a){p5.Oscillator.call(this,a,"sine")},p5.SinOsc.prototype=Object.create(p5.Oscillator.prototype),p5.TriOsc=function(a){p5.Oscillator.call(this,a,"triangle")},p5.TriOsc.prototype=Object.create(p5.Oscillator.prototype),p5.SawOsc=function(a){p5.Oscillator.call(this,a,"sawtooth")},p5.SawOsc.prototype=Object.create(p5.Oscillator.prototype),p5.SqrOsc=function(a){p5.Oscillator.call(this,a,"square")},p5.SqrOsc.prototype=Object.create(p5.Oscillator.prototype)}(master,Tone_signal_Signal,Tone_signal_Add,Tone_signal_Multiply,Tone_signal_Scale);var env;env=function(){"use strict";var a=master,b=Tone_signal_Add,c=Tone_signal_Multiply,d=Tone_signal_Scale,e=Tone_core_Tone;e.setContext(a.audiocontext);var f=null;p5.Env=function(b,c,d,e,f,g,h,i){this.aTime=b,this.aLevel=c,this.dTime=d||0,this.dLevel=e||0,this.sTime=f||0,this.sLevel=g||0,this.rTime=h||0,this.rLevel=i||0,this.output=a.audiocontext.createGain(),this.control=new p5.Signal,this.control.connect(this.output),this.timeoutID=null,this.connection=null,this.mathOps=[this.control],a.soundArray.push(this)},p5.Env.prototype.set=function(a,b,c,d,e,f,g,h){this.aTime=a,this.aLevel=b,this.dTime=c||0,this.dLevel=d||0,this.sTime=e||0,this.sLevel=f||0,this.rTime=g||0,this.rLevel=h||0},p5.Env.prototype.setInput=function(a){this.connect(a)},p5.Env.prototype.ctrl=function(a){this.connect(a)},p5.Env.prototype.play=function(b,c){var d=a.audiocontext.currentTime,e=c||0,f=d+e+1e-4;"number"==typeof this.timeoutID&&window.clearTimeout(this.timeoutID),b&&this.connection!==b&&this.connect(b),this.control.cancelScheduledValues(f-1e-4),this.control.linearRampToValueAtTime(0,f-5e-5),this.control.linearRampToValueAtTime(this.aLevel,f+this.aTime),this.control.linearRampToValueAtTime(this.dLevel,f+this.aTime+this.dTime),this.control.linearRampToValueAtTime(this.sLevel,f+this.aTime+this.dTime+this.sTime),this.control.linearRampToValueAtTime(this.rLevel,f+this.aTime+this.dTime+this.sTime+this.rTime);f+this.aTime+this.dTime+this.sTime+this.rTime},p5.Env.prototype.triggerAttack=function(b,c){var d=a.audiocontext.currentTime,e=c||0,f=d+e+1e-4;this.lastAttack=f,"number"==typeof this.timeoutID&&window.clearTimeout(this.timeoutID);var g=this.control.getValue();this.control.cancelScheduledValues(f-1e-4),this.control.linearRampToValueAtTime(g,f-5e-5),b&&this.connection!==b&&this.connect(b),this.control.linearRampToValueAtTime(this.aLevel,f+this.aTime),this.control.linearRampToValueAtTime(this.aLevel,f+this.aTime),this.control.linearRampToValueAtTime(this.dLevel,f+this.aTime+this.dTime),this.control.linearRampToValueAtTime(this.sLevel,f+this.aTime+this.dTime+this.sTime)},p5.Env.prototype.triggerRelease=function(b,c){var d,e=a.audiocontext.currentTime,g=c||0,h=e+g+1e-5;if(b&&this.connection!==b&&this.connect(b),this.control.cancelScheduledValues(h-1e-5),e-this.lastAttack<this.aTime){var i=this.aTime-(h-this.lastAttack);this.control.linearRampToValueAtTime(this.aLevel,h+i),this.control.linearRampToValueAtTime(this.dLevel,h+i+this.dTime),this.control.linearRampToValueAtTime(this.sLevel,h+i+this.dTime+this.sTime),this.control.linearRampToValueAtTime(this.rLevel,h+i+this.dTime+this.sTime+this.rTime),d=h+this.dTime+this.sTime+this.rTime}else if(e-this.lastAttack<this.aTime+this.dTime){var j=this.aTime+this.dTime-(e-this.lastAttack);this.control.linearRampToValueAtTime(this.dLevel,h+j),this.control.linearRampToValueAtTime(this.sLevel,h+j+.01),this.control.linearRampToValueAtTime(this.rLevel,h+j+.01+this.rTime),d=h+this.sTime+this.rTime}else if(e-this.lastAttack<this.aTime+this.dTime+this.sTime){var k=this.aTime+this.dTime+this.sTime-(e-this.lastAttack);this.control.linearRampToValueAtTime(this.sLevel,h+k),this.control.linearRampToValueAtTime(this.rLevel,h+k+this.rTime),d=h+this.rTime}else this.control.linearRampToValueAtTime(this.sLevel,h),this.control.linearRampToValueAtTime(this.rLevel,h+this.rTime),d=h+this.dTime+this.sTime+this.rTime;var l=h+this.aTime+this.dTime+this.sTime+this.rTime;this.connection&&this.connection.hasOwnProperty("oscillator")?(f=this.connection.oscillator,f.stop(l+.01)):this.connect&&this.connection.hasOwnProperty("source")&&(f=this.connection.source,f.stop(l+.01))},p5.Env.prototype.connect=function(b){this.disconnect(),this.connection=b,(b instanceof p5.Oscillator||b instanceof p5.SoundFile||b instanceof p5.AudioIn||b instanceof p5.Reverb||b instanceof p5.Noise||b instanceof p5.Filter||b instanceof p5.Delay)&&(b=b.output.gain),b instanceof AudioParam&&b.setValueAtTime(0,a.audiocontext.currentTime),b instanceof p5.Signal&&b.setValue(0),this.output.connect(b)},p5.Env.prototype.disconnect=function(a){this.output.disconnect()},p5.Env.prototype.add=function(a){var c=new b(a),d=this.mathOps.length,e=this.output;return p5.prototype._mathChain(this,c,d,e,b)},p5.Env.prototype.mult=function(a){var b=new c(a),d=this.mathOps.length,e=this.output;return p5.prototype._mathChain(this,b,d,e,c)},p5.Env.prototype.scale=function(a,b,c,e){var f=new d(a,b,c,e),g=this.mathOps.length,h=this.output;return p5.prototype._mathChain(this,f,g,h,d)},p5.Env.prototype.dispose=function(){a.audiocontext.currentTime;this.disconnect(),this.control.dispose(),this.control=null;for(var b=1;b<this.mathOps.length;b++)mathOps[b].dispose()}}(master,Tone_signal_Add,Tone_signal_Multiply,Tone_signal_Scale,Tone_core_Tone);var pulse;pulse=function(){"use strict";function a(){for(var a=b.audiocontext,c=a.createBuffer(1,2048,a.sampleRate),d=c.getChannelData(0),e=0;e<2048;e++)d[e]=1;var f=a.createBufferSource();return f.buffer=c,f.loop=!0,f}var b=master;p5.Pulse=function(c,d){p5.Oscillator.call(this,c,"sawtooth"),this.w=d||0,this.osc2=new p5.SawOsc(c),this.dNode=b.audiocontext.createDelay(),this.dcOffset=a(),this.dcGain=b.audiocontext.createGain(),this.dcOffset.connect(this.dcGain),this.dcGain.connect(this.output),this.f=c||440;var e=this.w/this.oscillator.frequency.value;this.dNode.delayTime.value=e,this.dcGain.gain.value=1.7*(.5-this.w),this.osc2.disconnect(),this.osc2.output.gain.minValue=-10,this.osc2.output.gain.maxValue=10,this.osc2.panner.disconnect(),this.osc2.amp(-1),this.osc2.output.connect(this.dNode),this.dNode.connect(this.output),this.output.gain.value=1,this.output.connect(this.panner)},p5.Pulse.prototype=Object.create(p5.Oscillator.prototype),p5.Pulse.prototype.width=function(a){if("number"==typeof a){if(a<=1&&a>=0){this.w=a;var b=this.w/this.oscillator.frequency.value;this.dNode.delayTime.value=b}this.dcGain.gain.value=1.7*(.5-this.w)}else{a.connect(this.dNode.delayTime);var c=new p5.SignalAdd(-.5);c.setInput(a),c=c.mult(-1),c=c.mult(1.7),c.connect(this.dcGain.gain)}},p5.Pulse.prototype.start=function(c,d){var e=b.audiocontext.currentTime,f=d||0;if(!this.started){var g=c||this.f,h=this.oscillator.type;this.oscillator=b.audiocontext.createOscillator(),this.oscillator.frequency.setValueAtTime(g,e),this.oscillator.type=h,this.oscillator.connect(this.output),this.oscillator.start(f+e),this.osc2.oscillator=b.audiocontext.createOscillator(),this.osc2.oscillator.frequency.setValueAtTime(g,f+e),this.osc2.oscillator.type=h,this.osc2.oscillator.connect(this.osc2.output),this.osc2.start(f+e),this.freqNode=[this.oscillator.frequency,this.osc2.oscillator.frequency],this.dcOffset=a(),this.dcOffset.connect(this.dcGain),this.dcOffset.start(f+e),void 0!==this.mods&&void 0!==this.mods.frequency&&(this.mods.frequency.connect(this.freqNode[0]),this.mods.frequency.connect(this.freqNode[1])),this.started=!0,this.osc2.started=!0}},p5.Pulse.prototype.stop=function(a){if(this.started){var c=a||0,d=b.audiocontext.currentTime;this.oscillator.stop(c+d),this.osc2.oscillator.stop(c+d),this.dcOffset.stop(c+d),this.started=!1,this.osc2.started=!1}},p5.Pulse.prototype.freq=function(a,c,d){if("number"==typeof a){this.f=a;var e=b.audiocontext.currentTime,c=c||0,d=d||0,f=this.oscillator.frequency.value;this.oscillator.frequency.cancelScheduledValues(e),this.oscillator.frequency.setValueAtTime(f,e+d),this.oscillator.frequency.exponentialRampToValueAtTime(a,d+c+e),this.osc2.oscillator.frequency.cancelScheduledValues(e),this.osc2.oscillator.frequency.setValueAtTime(f,e+d),this.osc2.oscillator.frequency.exponentialRampToValueAtTime(a,d+c+e),this.freqMod&&(this.freqMod.output.disconnect(),this.freqMod=null)}else a.output&&(a.output.disconnect(),a.output.connect(this.oscillator.frequency),a.output.connect(this.osc2.oscillator.frequency),this.freqMod=a)}}(master,oscillator);var noise;noise=function(){"use strict";var a=master;p5.Noise=function(a){p5.Oscillator.call(this),delete this.f,delete this.freq,delete this.oscillator,this.buffer=b},p5.Noise.prototype=Object.create(p5.Oscillator.prototype);var b=function(){for(var b=2*a.audiocontext.sampleRate,c=a.audiocontext.createBuffer(1,b,a.audiocontext.sampleRate),d=c.getChannelData(0),e=0;e<b;e++)d[e]=2*Math.random()-1;return c.type="white",c}(),c=function(){var b,c,d,e,f,g,h,i=2*a.audiocontext.sampleRate,j=a.audiocontext.createBuffer(1,i,a.audiocontext.sampleRate),k=j.getChannelData(0);b=c=d=e=f=g=h=0;for(var l=0;l<i;l++){var m=2*Math.random()-1;b=.99886*b+.0555179*m,c=.99332*c+.0750759*m,d=.969*d+.153852*m,e=.8665*e+.3104856*m,f=.55*f+.5329522*m,g=-.7616*g-.016898*m,k[l]=b+c+d+e+f+g+h+.5362*m,k[l]*=.11,h=.115926*m}return j.type="pink",j}(),d=function(){for(var b=2*a.audiocontext.sampleRate,c=a.audiocontext.createBuffer(1,b,a.audiocontext.sampleRate),d=c.getChannelData(0),e=0,f=0;f<b;f++){var g=2*Math.random()-1;d[f]=(e+.02*g)/1.02,e=d[f],d[f]*=3.5}return c.type="brown",c}();p5.Noise.prototype.setType=function(e){switch(e){case"white":this.buffer=b;break;case"pink":this.buffer=c;break;case"brown":this.buffer=d;break;default:this.buffer=b}if(this.started){var f=a.audiocontext.currentTime;this.stop(f),this.start(f+.01)}},p5.Noise.prototype.getType=function(){return this.buffer.type},p5.Noise.prototype.start=function(){this.started&&this.stop(),this.noise=a.audiocontext.createBufferSource(),this.noise.buffer=this.buffer,this.noise.loop=!0,this.noise.connect(this.output);var b=a.audiocontext.currentTime;this.noise.start(b),this.started=!0},p5.Noise.prototype.stop=function(){var b=a.audiocontext.currentTime;this.noise&&(this.noise.stop(b),this.started=!1)},p5.Noise.prototype.dispose=function(){var b=a.audiocontext.currentTime;this.noise&&(this.noise.disconnect(),this.stop(b)),this.output&&this.output.disconnect(),this.panner&&this.panner.disconnect(),this.output=null,this.panner=null,this.buffer=null,this.noise=null}}(master);var audioin;audioin=function(){"use strict";var a=master;p5.AudioIn=function(){this.input=a.audiocontext.createGain(),this.output=a.audiocontext.createGain(),this.stream=null,this.mediaStream=null,this.currentSource=0,this.enabled=!1,this.amplitude=new p5.Amplitude,this.output.connect(this.amplitude.input),"undefined"==typeof window.MediaStreamTrack?console.log("This browser does not support MediaStreamTrack"):"undefined"!=typeof window.MediaStreamTrack.getSources&&window.MediaStreamTrack.getSources(this._gotSources),a.soundArray.push(this)},p5.AudioIn.prototype.start=function(){var b=this;if(a.inputSources[b.currentSource]){var c=a.inputSources[b.currentSource].id,d={audio:{optional:[{sourceId:c}]}};navigator.getUserMedia(d,this._onStream=function(c){b.stream=c,b.enabled=!0,b.mediaStream=a.audiocontext.createMediaStreamSource(c),b.mediaStream.connect(b.output),b.amplitude.setInput(b.output)},this._onStreamError=function(a){console.error(a)})}else window.navigator.getUserMedia({audio:!0},this._onStream=function(c){b.stream=c,b.enabled=!0,b.mediaStream=a.audiocontext.createMediaStreamSource(c),b.mediaStream.connect(b.output),b.amplitude.setInput(b.output)},this._onStreamError=function(a){console.error(a)})},p5.AudioIn.prototype.stop=function(){this.stream&&this.stream.stop()},p5.AudioIn.prototype.connect=function(b){b?b.hasOwnProperty("input")?this.output.connect(b.input):b.hasOwnProperty("analyser")?this.output.connect(b.analyser):this.output.connect(b):this.output.connect(a.input)},p5.AudioIn.prototype.disconnect=function(a){this.output.disconnect(a),this.output.connect(this.amplitude.input)},p5.AudioIn.prototype.getLevel=function(a){return a&&(this.amplitude.smoothing=a),this.amplitude.getLevel()},p5.AudioIn.prototype._gotSources=function(b){for(var c=0;c!==b.length;c++){var d=b[c];"audio"===d.kind&&a.inputSources.push(d)}},p5.AudioIn.prototype.amp=function(b,c){if(c){var d=c||0,e=this.output.gain.value;this.output.gain.cancelScheduledValues(a.audiocontext.currentTime),this.output.gain.setValueAtTime(e,a.audiocontext.currentTime),this.output.gain.linearRampToValueAtTime(b,d+a.audiocontext.currentTime)}else this.output.gain.cancelScheduledValues(a.audiocontext.currentTime),this.output.gain.setValueAtTime(b,a.audiocontext.currentTime)},p5.AudioIn.prototype.listSources=function(){return console.log("input sources: "),console.log(a.inputSources),a.inputSources.length>0?a.inputSources:"This browser does not support MediaStreamTrack.getSources()"},p5.AudioIn.prototype.setSource=function(b){var c=this;a.inputSources.length>0&&b<a.inputSources.length?(c.currentSource=b,console.log("set source to "+a.inputSources[c.currentSource].id)):console.log("unable to set input source")},p5.AudioIn.prototype.dispose=function(){this.stop(),this.output&&this.output.disconnect(),this.amplitude&&this.amplitude.disconnect(),this.amplitude=null,this.output=null}}(master);var filter;filter=function(){"use strict";var a=master;p5.Filter=function(b){this.ac=a.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.biquad=this.ac.createBiquadFilter(),this.input.connect(this.biquad),this.biquad.connect(this.output),this.connect(),b&&this.setType(b)},p5.Filter.prototype.process=function(a,b,c){a.connect(this.input),this.set(b,c)},p5.Filter.prototype.set=function(a,b,c){a&&this.freq(a,c),b&&this.res(b,c)},p5.Filter.prototype.freq=function(a,b){var c=this,d=b||0;return a<=0&&(a=1),"number"==typeof a?(c.biquad.frequency.value=a,c.biquad.frequency.cancelScheduledValues(this.ac.currentTime+.01+d),c.biquad.frequency.exponentialRampToValueAtTime(a,this.ac.currentTime+.02+d)):a&&a.connect(this.biquad.frequency),c.biquad.frequency.value},p5.Filter.prototype.res=function(a,b){var c=this,d=b||0;return"number"==typeof a?(c.biquad.Q.value=a,c.biquad.Q.cancelScheduledValues(c.ac.currentTime+.01+d),c.biquad.Q.linearRampToValueAtTime(a,c.ac.currentTime+.02+d)):a&&freq.connect(this.biquad.Q),c.biquad.Q.value},p5.Filter.prototype.setType=function(a){this.biquad.type=a},p5.Filter.prototype.amp=function(b,c,d){var c=c||0,d=d||0,e=a.audiocontext.currentTime,f=this.output.gain.value;this.output.gain.cancelScheduledValues(e),this.output.gain.linearRampToValueAtTime(f,e+d+.001),this.output.gain.linearRampToValueAtTime(b,e+d+c+.001)},p5.Filter.prototype.connect=function(a){var b=a||p5.soundOut.input;this.output.connect(b)},p5.Filter.prototype.disconnect=function(){this.output.disconnect()},p5.LowPass=function(){p5.Filter.call(this,"lowpass")},p5.LowPass.prototype=Object.create(p5.Filter.prototype),p5.HighPass=function(){p5.Filter.call(this,"highpass")},p5.HighPass.prototype=Object.create(p5.Filter.prototype),p5.BandPass=function(){p5.Filter.call(this,"bandpass")},p5.BandPass.prototype=Object.create(p5.Filter.prototype)}(master);var delay;delay=function(){"use strict";var a=master;p5.Delay=function(){this.ac=a.audiocontext,this.input=this.ac.createGain(),this.output=this.ac.createGain(),this._split=this.ac.createChannelSplitter(2),this._merge=this.ac.createChannelMerger(2),this._leftGain=this.ac.createGain(),this._rightGain=this.ac.createGain(),this.leftDelay=this.ac.createDelay(),this.rightDelay=this.ac.createDelay(),this._leftFilter=new p5.Filter,this._rightFilter=new p5.Filter,this._leftFilter.disconnect(),this._rightFilter.disconnect(),this.lowPass=this._leftFilter,this._leftFilter.biquad.frequency.setValueAtTime(1200,this.ac.currentTime),this._rightFilter.biquad.frequency.setValueAtTime(1200,this.ac.currentTime),this._leftFilter.biquad.Q.setValueAtTime(.3,this.ac.currentTime),this._rightFilter.biquad.Q.setValueAtTime(.3,this.ac.currentTime),this.input.connect(this._split),this.leftDelay.connect(this._leftGain),this.rightDelay.connect(this._rightGain),this._leftGain.connect(this._leftFilter.input),this._rightGain.connect(this._rightFilter.input),this._merge.connect(this.output),this.output.connect(p5.soundOut.input),this._leftFilter.biquad.gain.setValueAtTime(1,this.ac.currentTime),this._rightFilter.biquad.gain.setValueAtTime(1,this.ac.currentTime),this.setType(0),this._maxDelay=this.leftDelay.delayTime.maxValue},p5.Delay.prototype.process=function(a,b,c,d){var e=c||0,f=b||0;if(e>=1)throw new Error("Feedback value will force a positive feedback loop.");if(f>=this._maxDelay)throw new Error("Delay Time exceeds maximum delay time of "+this._maxDelay+" second.");a.connect(this.input),this.leftDelay.delayTime.setValueAtTime(f,this.ac.currentTime),this.rightDelay.delayTime.setValueAtTime(f,this.ac.currentTime),this._leftGain.gain.setValueAtTime(e,this.ac.currentTime),this._rightGain.gain.setValueAtTime(e,this.ac.currentTime),d&&(this._leftFilter.freq(d),this._rightFilter.freq(d))},p5.Delay.prototype.delayTime=function(a){"number"!=typeof a?(a.connect(this.leftDelay.delayTime),a.connect(this.rightDelay.delayTime)):(this.leftDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.rightDelay.delayTime.cancelScheduledValues(this.ac.currentTime),this.leftDelay.delayTime.linearRampToValueAtTime(a,this.ac.currentTime),this.rightDelay.delayTime.linearRampToValueAtTime(a,this.ac.currentTime))},p5.Delay.prototype.feedback=function(a){if("number"!=typeof a)a.connect(this._leftGain.gain),a.connect(this._rightGain.gain);else{if(a>=1)throw new Error("Feedback value will force a positive feedback loop.");this._leftGain.gain.exponentialRampToValueAtTime(a,this.ac.currentTime),this._rightGain.gain.exponentialRampToValueAtTime(a,this.ac.currentTime)}},p5.Delay.prototype.filter=function(a,b){this._leftFilter.set(a,b),this._rightFilter.set(a,b)},p5.Delay.prototype.setType=function(a){switch(1===a&&(a="pingPong"),this._split.disconnect(),this._leftFilter.disconnect(),this._rightFilter.disconnect(),this._split.connect(this.leftDelay,0),this._split.connect(this.rightDelay,1),a){case"pingPong":this._rightFilter.setType(this._leftFilter.biquad.type),this._leftFilter.output.connect(this._merge,0,0),this._rightFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.rightDelay),this._rightFilter.output.connect(this.leftDelay);break;default:this._leftFilter.output.connect(this._merge,0,0),this._leftFilter.output.connect(this._merge,0,1),this._leftFilter.output.connect(this.leftDelay),this._leftFilter.output.connect(this.rightDelay)}},p5.Delay.prototype.amp=function(b,c,d){var c=c||0,d=d||0,e=a.audiocontext.currentTime,f=this.output.gain.value;this.output.gain.cancelScheduledValues(e),this.output.gain.linearRampToValueAtTime(f,e+d+.001),this.output.gain.linearRampToValueAtTime(b,e+d+c+.001)},p5.Delay.prototype.connect=function(a){var b=a||p5.soundOut.input;this.output.connect(b)},p5.Delay.prototype.disconnect=function(){this.output.disconnect()}}(master,filter);var reverb;reverb=function(){"use strict";var a=master;p5.Reverb=function(){this.ac=a.audiocontext,this.convolverNode=this.ac.createConvolver(),this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.convolverNode),this.convolverNode.connect(this.output),this._seconds=3,this._decay=2,this._reverse=!1,this._buildImpulse(),this.connect(),a.soundArray.push(this)},p5.Reverb.prototype.process=function(a,b,c,d){a.connect(this.input);var e=!1;b&&(this._seconds=b,e=!0),c&&(this._decay=c),d&&(this._reverse=d),e&&this._buildImpulse()},p5.Reverb.prototype.set=function(a,b,c){var d=!1;a&&(this._seconds=a,d=!0),b&&(this._decay=b),c&&(this._reverse=c),d&&this._buildImpulse()},p5.Reverb.prototype.amp=function(b,c,d){var c=c||0,d=d||0,e=a.audiocontext.currentTime,f=this.output.gain.value;this.output.gain.cancelScheduledValues(e),this.output.gain.linearRampToValueAtTime(f,e+d+.001),this.output.gain.linearRampToValueAtTime(b,e+d+c+.001)},p5.Reverb.prototype.connect=function(a){var b=a||p5.soundOut.input;this.output.connect(b.input?b.input:b)},p5.Reverb.prototype.disconnect=function(){this.output.disconnect()},p5.Reverb.prototype._buildImpulse=function(){var a,b,c=this.ac.sampleRate,d=c*this._seconds,e=this._decay,f=this.ac.createBuffer(2,d,c),g=f.getChannelData(0),h=f.getChannelData(1);for(b=0;b<d;b++)a=this.reverse?d-b:b,g[b]=(2*Math.random()-1)*Math.pow(1-a/d,e),h[b]=(2*Math.random()-1)*Math.pow(1-a/d,e);this.convolverNode.buffer=f},p5.Reverb.prototype.dispose=function(){this.convolverNode.buffer=null,this.convolverNode=null,"undefined"!=typeof this.output&&(this.output.disconnect(),this.output=null),"undefined"!=typeof this.panner&&(this.panner.disconnect(),this.panner=null)},p5.Convolver=function(b,c){this.ac=a.audiocontext,this.convolverNode=this.ac.createConvolver(),this.input=this.ac.createGain(),this.output=this.ac.createGain(),this.input.gain.value=.5,this.input.connect(this.convolverNode),this.convolverNode.connect(this.output),b?(this.impulses=[],this._loadBuffer(b,c)):(this._seconds=3,this._decay=2,this._reverse=!1,this._buildImpulse()),this.connect(),a.soundArray.push(this)},p5.Convolver.prototype=Object.create(p5.Reverb.prototype),p5.prototype.registerPreloadMethod("createConvolver"),p5.prototype.createConvolver=function(a,b){window.location.origin.indexOf("file://")>-1&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS");var c=new p5.Convolver(a,b);return c.impulses=[],c},p5.Convolver.prototype._loadBuffer=function(a,b){a=p5.prototype._checkFileFormats(a);var c=new XMLHttpRequest;c.open("GET",a,!0),c.responseType="arraybuffer";var d=this;c.onload=function(){var e=p5.prototype.getAudioContext();e.decodeAudioData(c.response,function(c){var e={},f=a.split("/");e.name=f[f.length-1],e.audioBuffer=c,d.impulses.push(e),d.convolverNode.buffer=e.audioBuffer,b&&b(e)})},c.send()},p5.Convolver.prototype.set=null,p5.Convolver.prototype.process=function(a){a.connect(this.input)},p5.Convolver.prototype.impulses=[],p5.Convolver.prototype.addImpulse=function(a,b){window.location.origin.indexOf("file://")>-1&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this._loadBuffer(a,b)},p5.Convolver.prototype.resetImpulse=function(a,b){window.location.origin.indexOf("file://")>-1&&alert("This sketch may require a server to load external files. Please see http://bit.ly/1qcInwS"),this.impulses=[],this._loadBuffer(a,b)},p5.Convolver.prototype.toggleImpulse=function(a){if("number"==typeof a&&a<this.impulses.length&&(this.convolverNode.buffer=this.impulses[a].audioBuffer),"string"==typeof a)for(var b=0;b<this.impulses.length;b++)if(this.impulses[b].name===a){this.convolverNode.buffer=this.impulses[b].audioBuffer;break}},p5.Convolver.prototype.dispose=function(){for(var a in this.impulses)this.impulses[a]=null;this.convolverNode.disconnect(),this.concolverNode=null,"undefined"!=typeof this.output&&(this.output.disconnect(),this.output=null),"undefined"!=typeof this.panner&&(this.panner.disconnect(),this.panner=null)}}(master,sndcore);var Tone_core_Clock;Tone_core_Clock=function(a){"use strict";return a.Clock=function(b,c){this._oscillator=null,this._jsNode=this.context.createScriptProcessor(this.bufferSize,1,1),this._jsNode.onaudioprocess=this._processBuffer.bind(this),this._controlSignal=new a.Signal(1),this._upTick=!1,this.tick=this.defaultArg(c,function(){}),this._jsNode.noGC(),this.setRate(b)},a.extend(a.Clock),a.Clock.prototype.setRate=function(a,b){var c=this.secondsToFrequency(this.toSeconds(a));b?this._controlSignal.exponentialRampToValueNow(c,b):(this._controlSignal.cancelScheduledValues(0),this._controlSignal.setValue(c))},a.Clock.prototype.getRate=function(){return this._controlSignal.getValue()},a.Clock.prototype.start=function(a){this._oscillator=this.context.createOscillator(),this._oscillator.type="square",this._oscillator.connect(this._jsNode),this._controlSignal.connect(this._oscillator.frequency),this._upTick=!1;var b=this.toSeconds(a);this._oscillator.start(b),this._oscillator.onended=function(){}},a.Clock.prototype.stop=function(a,b){var c=this.toSeconds(a);this._oscillator.onended=b,this._oscillator.stop(c)},a.Clock.prototype._processBuffer=function(a){for(var b=this.defaultArg(a.playbackTime,this.now()),c=this._jsNode.bufferSize,d=a.inputBuffer.getChannelData(0),e=this._upTick,f=this,g=0;g<c;g++){var h=d[g];h>0&&!e?(e=!0,setTimeout(function(){var a=b+f.samplesToSeconds(g+2*c);return function(){f.tick(a)}}(),0)):h<0&&e&&(e=!1)}this._upTick=e},a.Clock.prototype.dispose=function(){this._jsNode.disconnect(),this._controlSignal.dispose(),this._oscillator&&(this._oscillator.onended(),this._oscillator.disconnect()),this._jsNode.onaudioprocess=function(){},this._jsNode=null,this._controlSignal=null,this._oscillator=null},a.Clock}(Tone_core_Tone);var metro;metro=function(){"use strict";var a=master,b=Tone_core_Clock,c=a.audiocontext;p5.Metro=function(){this.clock=new b(c.sampleRate,this.ontick.bind(this)),this.syncedParts=[],this.bpm=120,this._init(),this.tickCallback=function(){}};var d=0,e=0;p5.Metro.prototype.ontick=function(b){var c=b-d,f=b-a.audiocontext.currentTime;if(!(c-e<=-.02)){d=b;for(var g in this.syncedParts){var h=this.syncedParts[g];h.incrementStep(f);for(var i in h.phrases){var j=h.phrases[i],k=j.sequence,l=this.metroTicks%k.length;0!==k[l]&&(this.metroTicks<k.length||!j.looping)&&j.callback(k[l],f)}}this.metroTicks+=1,this.tickCallback(f)}},p5.Metro.prototype.setBPM=function(b,c){var d=60/(b*this.tatums);e=d;this.clock.setRate(d,c+a.audiocontext.currentTime),this.bpm=b},p5.Metro.prototype.getBPM=function(a){return this.clock.getRate()/this.tatums*60},p5.Metro.prototype._init=function(){this.metroTicks=0},p5.Metro.prototype.resetSync=function(a){this.syncedParts=[a]},p5.Metro.prototype.pushSync=function(a){this.syncedParts.push(a)},p5.Metro.prototype.start=function(a){var b=a||0;this.clock.start(b),this.setBPM(this.bpm)},p5.Metro.prototype.stop=function(a){var b=a||0;this.clock._oscillator&&this.clock.stop(b)},p5.Metro.prototype.beatLength=function(a){this.tatums=1/a/4}}(master,Tone_core_Clock);var looper;looper=function(){"use strict";function a(a){a.currentPart++,a.currentPart>=a.parts.length?(a.scoreStep=0,a.onended()):(a.scoreStep=0,a.parts[a.currentPart-1].stop(),a.parts[a.currentPart].start())}var b=master,c=120;p5.prototype.setBPM=function(a,d){c=a;for(var e in b.parts)b.parts[e].setBPM(c,d)},p5.Phrase=function(a,b,c){this.phraseStep=0,this.name=a,this.callback=b,this.sequence=c},p5.Part=function(a,d){this.length=a||0,this.partStep=0,
this.phrases=[],this.looping=!1,this.isPlaying=!1,this.onended=function(){this.stop()},this.tatums=d||.0625,this.metro=new p5.Metro,this.metro._init(),this.metro.beatLength(this.tatums),this.metro.setBPM(c),b.parts.push(this),this.callback=function(){}},p5.Part.prototype.setBPM=function(a,b){this.metro.setBPM(a,b)},p5.Part.prototype.getBPM=function(){return this.metro.getBPM()},p5.Part.prototype.start=function(a){if(!this.isPlaying){this.isPlaying=!0,this.metro.resetSync(this);var b=a||0;this.metro.start(b)}},p5.Part.prototype.loop=function(a){this.looping=!0,this.onended=function(){this.partStep=0};var b=a||0;this.start(b)},p5.Part.prototype.noLoop=function(){this.looping=!1,this.onended=function(){this.stop()}},p5.Part.prototype.stop=function(a){this.partStep=0,this.pause(a)},p5.Part.prototype.pause=function(a){this.isPlaying=!1;var b=a||0;this.metro.stop(b)},p5.Part.prototype.addPhrase=function(a,b,c){var d;if(3===arguments.length)d=new p5.Phrase(a,b,c);else{if(!(arguments[0]instanceof p5.Phrase))throw"invalid input. addPhrase accepts name, callback, array or a p5.Phrase";d=arguments[0]}this.phrases.push(d),d.sequence.length>this.length&&(this.length=d.sequence.length)},p5.Part.prototype.removePhrase=function(a){for(var b in this.phrases)this.phrases[b].name===a&&this.phrases.split(b,1)},p5.Part.prototype.getPhrase=function(a){for(var b in this.phrases)if(this.phrases[b].name===a)return this.phrases[b]},p5.Part.prototype.replaceSequence=function(a,b){for(var c in this.phrases)this.phrases[c].name===a&&(this.phrases[c].sequence=b)},p5.Part.prototype.incrementStep=function(a){this.partStep<this.length-1?(this.callback(a),this.partStep+=1):(this.looping&&this.callback(a),this.onended(),this.partStep=0)},p5.Part.prototype.onStep=function(a){this.callback=a},p5.Score=function(){this.parts=[],this.currentPart=0;var b=this;for(var c in arguments)this.parts[c]=arguments[c],this.parts[c].nextPart=this.parts[c+1],this.parts[c].onended=function(){b.resetPart(c),a(b)};this.looping=!1},p5.Score.prototype.onended=function(){this.looping?this.parts[0].start():this.parts[this.parts.length-1].onended=function(){this.stop(),this.resetParts()},this.currentPart=0},p5.Score.prototype.start=function(){this.parts[this.currentPart].start(),this.scoreStep=0},p5.Score.prototype.stop=function(){this.parts[this.currentPart].stop(),this.currentPart=0,this.scoreStep=0},p5.Score.prototype.pause=function(){this.parts[this.currentPart].stop()},p5.Score.prototype.loop=function(){this.looping=!0,this.start()},p5.Score.prototype.noLoop=function(){this.looping=!1},p5.Score.prototype.resetParts=function(){for(var a in this.parts)this.resetPart(a)},p5.Score.prototype.resetPart=function(a){this.parts[a].stop(),this.parts[a].partStep=0;for(var b in this.parts[a].phrases)this.parts[a].phrases[b].phraseStep=0},p5.Score.prototype.setBPM=function(a,b){for(var c in this.parts)this.parts[c].setBPM(a,b)}}(master);var soundRecorder;soundRecorder=function(){"use strict";function a(a,b){for(var c=a.length+b.length,d=new Float32Array(c),e=0,f=0;f<c;)d[f++]=a[e],d[f++]=b[e],e++;return d}function b(a,b,c){for(var d=c.length,e=0;e<d;e++)a.setUint8(b+e,c.charCodeAt(e))}var c=master,d=c.audiocontext;p5.SoundRecorder=function(){this.input=d.createGain(),this.output=d.createGain(),this.recording=!1,this.bufferSize=1024,this._channels=2,this._clear(),this._jsNode=d.createScriptProcessor(this.bufferSize,this._channels,2),this._jsNode.onaudioprocess=this._audioprocess.bind(this),this._callback=function(){},this._jsNode.connect(p5.soundOut._silentNode),this.setInput(),c.soundArray.push(this)},p5.SoundRecorder.prototype.setInput=function(a){this.input.disconnect(),this.input=null,this.input=d.createGain(),this.input.connect(this._jsNode),this.input.connect(this.output),a?a.connect(this.input):p5.soundOut.output.connect(this.input)},p5.SoundRecorder.prototype.record=function(a,b,c){this.recording=!0,b&&(this.sampleLimit=Math.round(b*d.sampleRate)),a&&c?this._callback=function(){this.buffer=this._getBuffer(),a.setBuffer(this.buffer),c()}:a&&(this._callback=function(){this.buffer=this._getBuffer(),a.setBuffer(this.buffer)})},p5.SoundRecorder.prototype.stop=function(){this.recording=!1,this._callback(),this._clear()},p5.SoundRecorder.prototype._clear=function(){this._leftBuffers=[],this._rightBuffers=[],this.recordedSamples=0,this.sampleLimit=null},p5.SoundRecorder.prototype._audioprocess=function(a){if(this.recording!==!1&&this.recording===!0)if(this.sampleLimit&&this.recordedSamples>=this.sampleLimit)this.stop();else{var b=a.inputBuffer.getChannelData(0),c=a.inputBuffer.getChannelData(1);this._leftBuffers.push(new Float32Array(b)),this._rightBuffers.push(new Float32Array(c)),this.recordedSamples+=this.bufferSize}},p5.SoundRecorder.prototype._getBuffer=function(){var a=[];return a.push(this._mergeBuffers(this._leftBuffers)),a.push(this._mergeBuffers(this._rightBuffers)),a},p5.SoundRecorder.prototype._mergeBuffers=function(a){for(var b=new Float32Array(this.recordedSamples),c=0,d=a.length,e=0;e<d;e++){var f=a[e];b.set(f,c),c+=f.length}return b},p5.SoundRecorder.prototype.dispose=function(){this._clear(),this._callback=function(){},this.input&&this.input.disconnect(),this.input=null,this._jsNode=null},p5.prototype.saveSound=function(c,d){var e=c.buffer.getChannelData(0),f=c.buffer.getChannelData(1),g=a(e,f),h=new ArrayBuffer(44+2*g.length),i=new DataView(h);b(i,0,"RIFF"),i.setUint32(4,44+2*g.length,!0),b(i,8,"WAVE"),b(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,2,!0),i.setUint32(24,44100,!0),i.setUint32(28,176400,!0),i.setUint16(32,4,!0),i.setUint16(34,16,!0),b(i,36,"data"),i.setUint32(40,2*g.length,!0);for(var j=g.length,k=44,l=1,m=0;m<j;m++)i.setInt16(k,g[m]*(32767*l),!0),k+=2;p5.prototype.writeFile([i],d,"wav")}}(sndcore,master);var src_app;src_app=function(){"use strict";var a=sndcore;return a}(sndcore,master,helpers,panner,soundfile,amplitude,fft,signal,oscillator,env,pulse,noise,audioin,filter,delay,reverb,metro,looper,soundRecorder);