/*! Sugarizer 2018-07-01 */
define(["sugar-web/activity/activity","mustache"],function(a,b){require(["domReady!"],function(c){function d(a,b,c){return c=c||"0",b=b||2,a+="",a.length>=b?a:new Array(b-a.length+1).join(c)+a}function e(){this.elem=document.createElement("li");var a=document.getElementById("stopwatch-list");a.appendChild(this.elem),this.template='<p class="counter">00:00:00</p><div class="buttons-group"><button class="start-stop-button start"></button><button class="reset-button"></button><button class="mark-button"></button><button class="clear-marks-button"></button></div><p class="marks"></p><button class="remove"></button>',this.elem.innerHTML=b.render(this.template,{}),this.counterElem=this.elem.querySelector(".counter"),this.marksElem=this.elem.querySelector(".marks"),this.running=!1,this.previousTime=Date.now(),this.tenthsOfSecond=0,this.seconds=0,this.minutes=0,this.marks=[];var c=this;this.startStopButton=this.elem.querySelector(".start-stop-button"),this.startStopButton.onclick=function(){c.onStartStopClicked()},this.resetButton=this.elem.querySelector(".reset-button"),this.resetButton.onclick=function(){c.onResetClicked()},this.markButton=this.elem.querySelector(".mark-button"),this.markButton.onclick=function(){c.onMarkClicked()},this.clearButton=this.elem.querySelector(".clear-marks-button"),this.clearButton.onclick=function(){c.onClearMarksClicked()},this.removeButton=this.elem.querySelector(".remove"),this.removeButton.onclick=function(){c.onRemoveClicked()}}a.setup();var f=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;e.prototype.onStartStopClicked=function(){this.running?this.running=!1:(this.running=!0,this.tick()),this.updateButtons()},e.prototype.onResetClicked=function(){this.tenthsOfSecond=0,this.seconds=0,this.minutes=0,this.running?this.onStartStopClicked():this.running=!1,this.updateView()},e.prototype.onMarkClicked=function(){this.marks.push(d(this.minutes)+":"+d(this.seconds)+"."+d(this.tenthsOfSecond)),this.updateMarks()},e.prototype.onClearMarksClicked=function(){this.marks=[],this.updateMarks()},e.prototype.onRemoveClicked=function(){var a=document.getElementById("stopwatch-list");a.removeChild(this.elem)},e.prototype.tick=function(){if(this.running){var a=Date.now();a-this.previousTime>100&&(this.previousTime=a,this.update(),this.updateView()),f(this.tick.bind(this))}},e.prototype.update=function(){this.tenthsOfSecond+=1,10==this.tenthsOfSecond&&(this.tenthsOfSecond=0,this.seconds+=1),60==this.seconds&&(this.seconds=0,this.minutes+=1)},e.prototype.updateView=function(){this.counterElem.innerHTML=d(this.minutes)+":"+d(this.seconds)+"."+d(this.tenthsOfSecond)},e.prototype.updateMarks=function(){this.marksElem.innerHTML="";for(var a=0;a<this.marks.length;a++)this.marksElem.innerHTML+=this.marks[a],a!==this.marks.length-1&&(this.marksElem.innerHTML+=" - ")},e.prototype.updateButtons=function(){this.running?(this.startStopButton.classList.add("stop"),this.startStopButton.classList.remove("start")):(this.startStopButton.classList.add("start"),this.startStopButton.classList.remove("stop"))};for(var g=0;g<5;g++)new e;var h=document.getElementById("add-stopwatch");h.onclick=function(){new e}})});