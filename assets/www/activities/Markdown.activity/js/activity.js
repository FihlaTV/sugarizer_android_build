/*! Sugarizer 2016-12-28 */
define(["sugar-web/activity/activity","webL10n","sugar-web/datastore"],function(a,b,c){require(["domReady!"],function(b){function d(a,b){if(document.selection)a.focus(),sel=document.selection.createRange(),sel.text=b;else if(a.selectionStart||"0"==a.selectionStart){var c=a.selectionStart,d=a.selectionEnd;a.value=a.value.substring(0,c)+b+a.value.substring(d,a.value.length)}else a.value+=b}function e(){var a=new Markdown.Converter,b=function(){alert(l10n_s.get("need-help"))},c={helpButton:{handler:b},strings:{quoteexample:l10n_s.get("put-it-right-here")}},d=new Markdown.Editor(a,"-second",c);d.run()}a.setup();var f=["insertText","wmd-bold-button-second","wmd-italic-button-second","wmd-heading-button","wmd-hr-button","wmd-olist-button","wmd-ulist-button","wmd-code-button","wmd-quote-button","wmd-link-button","wmd-undo-button","wmd-redo-button"];inputTextContent=document.getElementById("wmd-input-second"),inputTextContent.value="#"+l10n_s.get("sample-input");var g=a.getDatastoreObject();for(inputTextContent.onblur=function(){var a=JSON.stringify(inputTextContent.value.toString());g.setDataAsText(a),g.save(function(){})},e(),g.loadAsText(function(a,b,c){markdowntext=JSON.parse(c),inputTextContent.value=markdowntext,e()}),i=0;i<f.length;i++)document.getElementById(f[i]).title=l10n_s.get(f[i]);var h=document.getElementById("insertText");h.onclick=function(){a.showObjectChooser(function(a,b){var e=new c.DatastoreObject(b);e.loadAsText(function(a,b,c){try{textdata=JSON.parse(c)}catch(a){textdata=c}var e=document.getElementById("wmd-input-second");d(e,textdata)})})}})});